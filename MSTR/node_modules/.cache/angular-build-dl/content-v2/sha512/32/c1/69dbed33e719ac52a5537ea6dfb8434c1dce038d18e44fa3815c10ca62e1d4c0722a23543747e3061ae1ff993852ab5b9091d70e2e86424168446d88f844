{"version":3,"sources":["src/app/service/menu.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpHeaders, HttpClient} from '@angular/common/http';\nimport { Observable , throwError, TimeoutError, of } from 'rxjs';\nimport { map, filter, distinctUntilChanged, catchError, timeout, switchMap,retry } from 'rxjs/operators';\n\nimport {ApiCommonModule} from '../service/api-common/api-common.module';\nimport {CommonUtilityModule} from '../common/common-utility/common-utility.module';\n\n//import {MenuNode,ObjectNode, MyFlatTreeNode}from '../class/menu';\nimport * as Menu from '../class/menu';\nimport { IApiConfig } from '../class/environment';\n// import {menuData,ObjectData} from '../mock-data/menu';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MenuService {\n  apiId:string = \"mstrMenu\";\n  ApiConfig:IApiConfig;\n  constructor( \n    protected apiCommon:ApiCommonModule,\n    protected commonUtility:CommonUtilityModule,\n    private http: HttpClient\n  ) { }\n  getMenus(): Observable<Menu.resMenu>{\n    console.log(this.apiId);\n    this.ApiConfig = this.apiCommon.getApiConfigByApiID(this.apiId);\n    const apiUrl = `${this.ApiConfig.domain}${this.ApiConfig.path}`;\n    console.log(apiUrl);\n\n    const httpOptions = {\n      headers: new HttpHeaders({\n        'Content-Type':'application/json',\n        'UKEY':this.commonUtility.getSessionValue('authenticationToken'),\n        'KeyId':this.ApiConfig.keyId\n      })\n    };\n    // this.loadingService.show();\n    const rqbody:Menu.reqMenu={\n      UKEY:this.commonUtility.getSessionValue('authenticationToken'),\n      WEB_SYSTEM_CODE:this.commonUtility.systemCode,\n      USER_ID:this.commonUtility.getSessionValue('loginUser')\n    };\n\n    console.log(rqbody);\n    return this.http.post<Menu.resMenu>(apiUrl, JSON.stringify(rqbody), httpOptions)\n      .pipe(\n        timeout(90 * 1000),\n        catchError( error => {\n          console.log('error:', error);\n\n          // this.loadingService.hide();\n\n          if (error instanceof TimeoutError) {\n            // this.nativeService.alert({\n            //   TITLE: '系統連線逾時',\n            //   TYPE: 'CONFIRM',\n            // }).subscribe(()=>{\n            //   localStorage.clear();\n            //   this.nativeService.close();\n            // });\n          }\n          return throwError( error );\n        })\n      );\n    //this.messageService.add('HeroService: fetched heroes.');\n    // var rtn:Menu.resMenu;\n    // var mstrMenuData:Menu.mstrMenu;\n    // var mstrMenuNode:Menu.MenuNode[];\n    // var mstrObjectNode:Menu.ObjectNode[];\n    // mstrMenuData.menu=menuData;\n    // mstrMenuData.object=ObjectData;\n    // mstrMenuNode = menuData;\n    // mstrObjectNode = ObjectData;\n    // mstrMenuData.menu = mstrMenuNode;\n    // mstrMenuData.object = mstrObjectNode;\n\n    // rtn.ReturnCode=0;\n    // rtn.ReturnMessage=\"\";\n    // rtn.ReturnResult=mstrMenuData;\n    // console.log(rtn);\n    // return of(rtn);\n  }\n\n  getSubMenus(code:string):Observable<Menu.ObjectNode[]>{\n    let objData:Menu.ObjectNode[] = JSON.parse(sessionStorage.getItem(\"object\"));\n\n    console.log(code+\"_Service\");\n    console.log(objData.filter(menu=>menu.web_function==code));\n    return of(objData.filter(menu=>menu.web_function==code))\n    //return of (ObjectData.find(menu=>menu.web_function==code));\n    //return of(HEROES.find(hero=>hero.id==id));\n  }\n}\n"],"sourceRoot":"webpack:///"}