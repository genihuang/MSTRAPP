!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("@angular/common"),require("@allianz/ngx-ndbx/button"),require("@allianz/ngx-ndbx/icon"),require("@allianz/ngx-ndbx/input"),require("@angular/cdk/coercion"),require("@allianz/ngx-ndbx/utils"),require("@allianz/ngx-ndbx/core"),require("decimal.js"),require("@angular/forms"),require("@angular/core")):"function"==typeof define&&define.amd?define("@allianz/ngx-ndbx/number-stepper",["exports","rxjs","@angular/common","@allianz/ngx-ndbx/button","@allianz/ngx-ndbx/icon","@allianz/ngx-ndbx/input","@angular/cdk/coercion","@allianz/ngx-ndbx/utils","@allianz/ngx-ndbx/core","decimal.js","@angular/forms","@angular/core"],t):t((e.allianz=e.allianz||{},e.allianz["ngx-ndbx"]=e.allianz["ngx-ndbx"]||{},e.allianz["ngx-ndbx"]["number-stepper"]={}),e.rxjs,e.ng.common,e.allianz["ngx-ndbx"].button,e.allianz["ngx-ndbx"].icon,e.allianz["ngx-ndbx"].input,e.ng.cdk.coercion,e.allianz["ngx-ndbx"].utils,e.allianz["ngx-ndbx"].core,e.decimal_js,e.ng.forms,e.ng.core)}(this,function(e,t,n,i,r,s,a,o,p,u,l,c){"use strict";var h=function(){function e(){this.changes=new t.Subject,this.decrementAriaLabel="Decrement",this.incrementAriaLabel="Increment"}return e.decorators=[{type:c.Injectable}],e}(),d=function(){function e(e,t,n){this._element=e,this._renderer=t,this._cdr=n,this._resize=!0,this.updateInputWidth=this.updateInputWidth.bind(this)}return Object.defineProperty(e.prototype,"resize",{get:function(){return this._resize},set:function(e){this._resize=a.coerceBooleanProperty(e),this._resize?(this._addEventListener(),this.updateInputWidth()):this._removeEventListener()},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.resize&&this._addEventListener()},e.prototype.ngOnDestroy=function(){this._removeEventListener()},e.prototype.updateInputWidth=function(){var e=this._renderer.createElement("canvas").getContext("2d"),t=window.getComputedStyle(this._element.nativeElement);e.font=o.getFontShorthand(t);var n=e.measureText(this._element.nativeElement.value),i=this.sumStyles(t.paddingLeft,t.paddingRight),r=this.sumStyles(t.borderLeftWidth,t.borderRightWidth),s=n.width+i+r+16,a=parseFloat(t.minWidth);this.width=Math.max(Number.isNaN(a)?0:a,s),this._cdr.markForCheck()},e.prototype._addEventListener=function(){this._element.nativeElement.addEventListener("input",this.updateInputWidth,!0),this._element.nativeElement.addEventListener("change",this.updateInputWidth,!0)},e.prototype._removeEventListener=function(){this._element.nativeElement.removeEventListener("input",this.updateInputWidth,!0),this._element.nativeElement.removeEventListener("change",this.updateInputWidth,!0)},e.prototype.sumStyles=function(e,t){return e=parseInt(e,10),t=parseInt(t,10),(e=Number.isNaN(e)?0:e)+(t=Number.isNaN(t)?0:t)},e.decorators=[{type:c.Directive,args:[{selector:"input[nxAutoResize]"}]}],e.ctorParameters=function(){return[{type:c.ElementRef},{type:c.Renderer2},{type:c.ChangeDetectorRef}]},e.propDecorators={width:[{type:c.HostBinding,args:["style.width.px"]}],resize:[{type:c.Input,args:["nxAutoResize"]}]},e}(),g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var m={big:"nx-stepper--big",normal:""},x={regular:"",bold:"nx-stepper__input--bold",light:"nx-stepper__input--light"},_=["nx-stepper"],f=["nx-stepper__input"],b=new RegExp(/^-?[0-9]\d*(\.\d+)?$/g),y={provide:l.NG_VALUE_ACCESSOR,useExisting:c.forwardRef(function(){return N}),multi:!0},v={provide:l.NG_VALIDATORS,useExisting:c.forwardRef(function(){return N}),multi:!0},w=0,N=function(s){function e(e,t,n,i){var r=s.call(this,m,_,n,t)||this;return r._changeDetectorRef=e,r._intl=i,r._step=1,r._min=0,r._max=100,r._value=0,r._label=null,r._resize=!1,r._negative=!1,r._leadingZero=!0,r.inputClassNames=o.mapClassNames("regular",f,x),r.inputId="nx-number-stepper-"+w++,r.ariaDescribedBy=null,r.valueChange=new c.EventEmitter,r.onChangeCallback=function(e){},r.onTouchedCallback=function(){},r._intlSubscription=r._intl.changes.subscribe(function(){return r._changeDetectorRef.markForCheck()}),r}return function i(e,t){function n(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(e,s),Object.defineProperty(e.prototype,"resize",{get:function(){return this._resize},set:function(e){this._resize=a.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(e){this._label!==e&&(this._label=e,this._changeDetectorRef.markForCheck())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(e){this._style!==e&&(this._style=e,this.inputClassNames=o.mapClassNames(e,f,x),this._changeDetectorRef.markForCheck())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(e){this._step=Number(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(e){this._min=Number(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(e){this._max=Number(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,null!==this._value?this.setInputValue(this._value):this.setInputValue(0),this.triggerResize(),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"negative",{get:function(){return this._negative},set:function(e){this._negative!==e&&(this._negative=a.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leadingZero",{get:function(){return this._leadingZero},set:function(e){this._leadingZero!==e&&(this._leadingZero=a.coerceBooleanProperty(e),this.setInputValue(this.value))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.setInputValue(this._value)},e.prototype.ngAfterViewInit=function(){var e=this;this.resize&&setTimeout(function(){return e.triggerResize()}),this.ngContentWrapper&&(this.ariaDescribedBy=0<this.ngContentWrapper.nativeElement.children.length?"label-for-"+this.inputId:null)},e.prototype.ngOnDestroy=function(){this._intlSubscription.unsubscribe()},e.prototype.setInputValue=function(e){this.leadingZero?this.numberInput.nativeElement.value=o.pad(e.toString(),2):this.numberInput.nativeElement.value=e.toString()},e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){this.onTouchedCallback=e},e.prototype.onInputChange=function(e){this.validateUserInput(e.target.value)?this._value=Number(e.target.value):this._value=null,this.valueChange.emit(this._value),this.onChangeCallback(this._value)},e.prototype.validateUserInput=function(e){return!!e.match(b)},e.prototype.increment=function(){var e;e=this.isBetweenLimits(this._value)?this.getNextGreaterValue(this._value):this.enforceLimits(this._value),this.value=e,this.valueChange.emit(this._value),this.onChangeCallback(this._value)},e.prototype.triggerResize=function(){this.resize&&(this.autoResize.updateInputWidth(),this._changeDetectorRef.markForCheck())},e.prototype.decrement=function(){var e;e=this.isBetweenLimits(this._value)?this.getNextLowerValue(this._value):this.enforceLimits(this._value),this.value=e,this.valueChange.emit(this._value),this.onChangeCallback(this._value)},e.prototype.enforceLimits=function(e){return e>this._max?this._max:e<this._min?this._min:e},e.prototype.getNextLowerValue=function(e){var t;return e||(e=0),t=this.isValidStep(e)?new u.Decimal(e).minus(new u.Decimal(this._step)).toNumber():new u.Decimal(e).toNearest(this._step,u.Decimal.ROUND_DOWN).toNumber(),this.enforceLimits(t)},e.prototype.getNextGreaterValue=function(e){var t;return e||(e=0),t=this.isValidStep(e)?new u.Decimal(e).plus(new u.Decimal(this._step)).toNumber():new u.Decimal(e).toNearest(this._step,u.Decimal.ROUND_UP).toNumber(),this.enforceLimits(t)},e.prototype.isBetweenLimits=function(e){return e<=this._max&&e>=this._min},e.prototype.isMinimum=function(){return this._value===this._min},e.prototype.isMaximum=function(){return this._value===this._max},e.prototype.isValidStep=function(e){null===e&&(e=new u.Decimal(0));var t=new u.Decimal(this._min),n=new u.Decimal(e),i=t.minus(n).mod(new u.Decimal(this._step)).toNumber();return!(!this.isBetweenLimits(e)||!this.isMinimum()&&!this.isMaximum()&&0!==i)},e.prototype.userInputToNumber=function(e){return parseInt(""===e?0:e,10)},e.prototype._validateFn=function(){return this.isValidStep(this._value)?null===this._value?{nxNumberStepperFormatError:"Not a valid number"}:null:{nxNumberStepperStepError:"Value is not a valid step"}},e.prototype.validate=function(e){return this._validateFn()},Object.defineProperty(e.prototype,"_buttonType",{get:function(){return"secondary"+(this.negative?" negative":"")},enumerable:!0,configurable:!0}),e.decorators=[{type:c.Component,args:[{selector:"nx-number-stepper",template:'<div *ngIf="label" class="nx-stepper__label">\n  <label [for]="inputId">\n    {{label}}\n  </label>\n</div>\n<div #customLabel *ngIf="!label" [id]="ariaDescribedBy">\n  <ng-content></ng-content>\n</div>\n<div class="nx-stepper__input-container">\n  <button\n    [attr.aria-label]="_intl.decrementAriaLabel"\n    [nxButton]="_buttonType"\n    class="nx-stepper__down nx-stepper__control"\n    (click)="decrement()"\n    [disabled]="value <= min">\n    <nx-icon name="minus" size="s"></nx-icon>\n  </button>\n  <div class="nx-stepper__input-wrapper">\n    <div class="nx-stepper__inner-wrapper">\n        <ng-content select="nx-number-stepper-prefix"></ng-content>\n\n        <input #numberInput [nxAutoResize]="resize"\n        [attr.aria-describedby]="ariaDescribedBy"\n        [id]="inputId" [ngClass]="inputClassNames"\n        (input)="onInputChange($event)"\n        (keydown.arrowup)="increment()"\n        (keydown.arrowdown)="decrement()"/>\n\n        <ng-content select="nx-number-stepper-suffix"></ng-content>\n    </div>\n    <div class="nx-stepper__input-underline"></div>\n  </div>\n\n  <button\n    [attr.aria-label]="_intl.incrementAriaLabel"\n    [nxButton]="_buttonType"\n    class="nx-stepper__up nx-stepper__control"\n    (click)="increment()"\n    [disabled]="value >= max">\n    <nx-icon name="plus" size="s"></nx-icon>\n  </button>\n</div>',changeDetection:c.ChangeDetectionStrategy.OnPush,inputs:["classNames: nxSize"],host:{"[class.is-negative]":"negative"},providers:[y,v],styles:[":host{display:block}:host input{padding:0}.nx-stepper__input-container{align-items:flex-end;display:flex;margin-top:12px}.nx-stepper__label{display:flex;font-size:20px;line-height:28px}.nx-stepper__control{width:32px;height:32px;min-height:32px;font-size:24px;margin:0;padding:0}.nx-stepper__control:disabled{background-color:rgba(255,255,255,.4);border-color:#006192;color:#006192;opacity:.4}.nx-stepper__input{width:56px;min-width:56px}.nx-stepper__input,::ng-deep .nx-stepper__prefix,::ng-deep .nx-stepper__suffix{background:0 0;outline:0;border:0;text-align:center;color:#414141;font-size:20px;line-height:28px;height:28px}::ng-deep .nx-stepper__suffix{margin-left:4px}::ng-deep .nx-stepper__prefix{margin-right:4px}.nx-stepper__input-wrapper{display:flex;align-items:center;flex-direction:column;margin:0 16px}.nx-stepper__inner-wrapper{height:28px;display:flex;align-items:baseline}.nx-stepper__input-underline{width:100%;margin-top:2px;height:2px;background:#414141}:host.nx-stepper--big .nx-stepper__control{width:72px;min-height:48px;margin-bottom:0}:host.nx-stepper--big .nx-stepper__input{width:72px;min-width:72px}:host.nx-stepper--big .nx-stepper__input,:host.nx-stepper--big ::ng-deep .nx-stepper__prefix,:host.nx-stepper--big ::ng-deep .nx-stepper__suffix{color:#414141;font-size:40px;line-height:48px;height:48px;letter-spacing:.3px;padding:0;margin-bottom:0}:host.nx-stepper--big .nx-stepper__input-wrapper{margin:0 24px}:host.nx-stepper--big .nx-stepper__input-underline{margin-top:-2px}:host.nx-stepper--big .nx-stepper__inner-wrapper{height:48px}:host.is-negative .nx-stepper__label{color:#fff}:host.is-negative .nx-stepper__input{color:#fff}:host.is-negative .nx-stepper__input-underline{background:#fff}"]}]}],e.ctorParameters=function(){return[{type:c.ChangeDetectorRef},{type:c.Renderer2},{type:c.ElementRef},{type:h}]},e.propDecorators={numberInput:[{type:c.ViewChild,args:["numberInput"]}],ngContentWrapper:[{type:c.ViewChild,args:["customLabel"]}],autoResize:[{type:c.ViewChild,args:[d]}],valueChange:[{type:c.Output,args:["nxValueChange"]}],resize:[{type:c.Input,args:["nxResize"]}],label:[{type:c.Input,args:["nxLabel"]}],style:[{type:c.Input,args:["nxStyle"]}],step:[{type:c.Input,args:["nxStep"]}],min:[{type:c.Input,args:["nxMin"]}],max:[{type:c.Input,args:["nxMax"]}],value:[{type:c.Input,args:["nxValue"]}],negative:[{type:c.Input}],leadingZero:[{type:c.Input}]},e}(p.MappedStyles),z=function(){function e(){}return e.decorators=[{type:c.Directive,args:[{selector:"nx-number-stepper-prefix",host:{"class":"nx-stepper__prefix"}}]}],e}(),I=function(){function e(){}return e.decorators=[{type:c.Directive,args:[{selector:"nx-number-stepper-suffix",host:{"class":"nx-stepper__suffix"}}]}],e}(),C=function(){function e(){}return e.decorators=[{type:c.NgModule,args:[{imports:[s.NxInputModule,l.FormsModule,r.NxIconModule,i.NxButtonModule,n.CommonModule],exports:[N,d,z,I],declarations:[N,d,z,I],providers:[h]}]}],e}();e.NxNumberStepperModule=C,e.NxNumberStepperComponent=N,e.NxNumberStepperPrefixDirective=z,e.NxNumberStepperSuffixDirective=I,e.NxNumberStepperIntl=h,e.ɵa=d,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=allianz-ngx-ndbx-number-stepper.umd.min.js.map