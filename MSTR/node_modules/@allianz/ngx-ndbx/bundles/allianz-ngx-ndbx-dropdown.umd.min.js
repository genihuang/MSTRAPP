!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@allianz/ngx-ndbx/icon"),require("@angular/common"),require("@allianz/ngx-ndbx/checkbox"),require("@angular/cdk/a11y"),require("@angular/cdk/collections"),require("@angular/cdk/keycodes"),require("@angular/cdk/overlay"),require("@angular/forms"),require("@allianz/ngx-ndbx/formfield"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/cdk/observers")):"function"==typeof define&&define.amd?define("@allianz/ngx-ndbx/dropdown",["exports","@allianz/ngx-ndbx/icon","@angular/common","@allianz/ngx-ndbx/checkbox","@angular/cdk/a11y","@angular/cdk/collections","@angular/cdk/keycodes","@angular/cdk/overlay","@angular/forms","@allianz/ngx-ndbx/formfield","rxjs","rxjs/operators","@angular/core","@angular/cdk/observers"],t):t((e.allianz=e.allianz||{},e.allianz["ngx-ndbx"]=e.allianz["ngx-ndbx"]||{},e.allianz["ngx-ndbx"].dropdown={}),e.allianz["ngx-ndbx"].icon,e.ng.common,e.allianz["ngx-ndbx"].checkbox,e.ng.cdk.a11y,e.ng.cdk.collections,e.ng.cdk.keycodes,e.ng.cdk.overlay,e.ng.forms,e.allianz["ngx-ndbx"].formfield,e.rxjs,e.rxjs.operators,e.ng.core,e.ng.cdk.observers)}(this,function(e,t,n,o,i,r,a,s,l,p,d,u,h,c){"use strict";var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function g(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=r.next()).done;)a.push(o.value)}catch(s){i={error:s}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}function m(){return Error("`compareWith` must be a function.")}var x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMultiSelect=!1,e}return g(e,t),e.propDecorators={isMultiSelect:[{type:h.Input,args:["nxIsMultiselect"]}]},e}(p.NxFormfieldControl),b=function(){function e(){}return e.decorators=[{type:h.Component,args:[{selector:"nx-dropdown-group",template:'<div class="nx-dropdown-results__group">\n  <div class="nx-dropdown-results__group-label">{{label}}</div>\n  <ng-content></ng-content>\n</div>\n',changeDetection:h.ChangeDetectionStrategy.OnPush,styles:[":host{display:block}:host:first-child .nx-dropdown-results__group{background-color:rgba(236,236,236,.5)}:host:first-child .nx-dropdown-results__group-label{padding-top:16px}.nx-dropdown-results__group-label{font-style:italic;padding:24px 32px 16px;font-weight:700;font-size:12px;line-height:16px}"]}]}],e.propDecorators={label:[{type:h.Input,args:["nxLabel"]}]},e}(),v=function S(e,t){void 0===t&&(t=!1),this.item=e,this.isUserInput=t},w=0,C=function(){function e(e,t,n,o){var i=this;this._dropdown=e,this.group=t,this._changeDetectorRef=n,this._elementRef=o,this._hidden=!1,this._mostRecentViewValue="",this._id="nx-dropdown-item-"+w++,this._selected=!1,this._destroy=new d.Subject,this.onSelectionChange=new h.EventEmitter,this._stateChanges=new d.Subject,this._dropdown.filterChanges.pipe(u.takeUntil(this._destroy)).subscribe(function(e){i._showOrHideByFilter(e)}),this._dropdown._closedStream.pipe(u.takeUntil(this._destroy)).subscribe(function(){i._hidden=!1})}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiselect",{get:function(){return this._dropdown&&this._dropdown.isMultiSelect},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewChecked=function(){if(this._selected){var e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}},e.prototype.ngOnDestroy=function(){this._stateChanges.complete(),this._destroy.next(),this._destroy.complete()},e.prototype._onClick=function(e){e.preventDefault(),e.stopPropagation(),this._selectViaInteraction()},e.prototype._selectViaInteraction=function(){this._selected=!this.multiselect||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0)},e.prototype.show=function(){this._hidden=!1,this._changeDetectorRef.markForCheck()},e.prototype.hide=function(){this._hidden=!0,this._changeDetectorRef.markForCheck()},e.prototype._showOrHideByFilter=function(e){var t=this._dropdown.filterFn(e,this.viewValue);this._hidden=!t,this._changeDetectorRef.markForCheck()},Object.defineProperty(e.prototype,"_formattedValue",{get:function(){return this._dropdown.valueFormatter(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewValue",{get:function(){return(this._elementRef.nativeElement.textContent||"").trim()},enumerable:!0,configurable:!0}),e.prototype.select=function(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())},e.prototype.deselect=function(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())},e.prototype.focus=function(){this._elementRef.nativeElement.focus()},e.prototype._emitSelectionChangeEvent=function(e){void 0===e&&(e=!1),this.onSelectionChange.emit(new v(this,e))},e.prototype.setActiveStyles=function(){this._active=!0,this._changeDetectorRef.markForCheck()},e.prototype.setInactiveStyles=function(){this._active=!1,this._changeDetectorRef.markForCheck()},e.prototype.getLabel=function(){return this.value},e.prototype._isContentEmpty=function(e){return 0===e.children.length&&!e.textContent.trim()},e.prototype._onLabelChange=function(){this._changeDetectorRef.detectChanges()},e.decorators=[{type:h.Component,args:[{selector:"nx-dropdown-item",template:'<div #container class="nx-dropdown-results__option"\n     [ngClass]="{\'nx-dropdown-results__option--selected\': selected}">\n\n   <nx-checkbox *ngIf="multiselect" [checked]="selected">\n      <ng-container *ngTemplateOutlet="contentTemplate"></ng-container>\n    </nx-checkbox>\n\n    <span *ngIf="!multiselect" class="nx-dropdown-results__option-checkicon">\n       <nx-icon name="check" aria-hidden="true"></nx-icon>\n    </span>\n\n    <ng-container *ngIf="!multiselect">\n      <ng-container *ngTemplateOutlet="contentTemplate"></ng-container>\n    </ng-container>\n</div>\n\n<ng-template #contentTemplate>\n  <div class="nx-dropdown-results__option-label" >\n    <span #content (cdkObserveContent)="_onLabelChange()">\n      <ng-content></ng-content>\n    </span>\n    <ng-container *ngIf="_isContentEmpty(content)">\n      {{_formattedValue}}\n    </ng-container>\n  </div>\n</ng-template>\n',changeDetection:h.ChangeDetectionStrategy.OnPush,host:{"[id]":"id",role:"option","[attr.aria-selected]":"selected.toString()","[class.nx-hidden]":"_hidden","[class.nx-dropdown-item--active]":"active","[class.nx-selected]":"selected","[class.nx-multiselect]":"multiselect","(click)":"_onClick($event)"},styles:[":host{display:block}:host(.nx-hidden){display:none}:host:first-child .nx-dropdown-results__option{padding-top:16px}nx-checkbox{margin-bottom:0}.nx-dropdown-results__option{font-size:20px;line-height:28px;letter-spacing:.2px;padding:0 32px 16px 8px;cursor:pointer;position:relative;display:flex;max-width:100%;white-space:nowrap}.nx-dropdown-results__option-label{overflow:hidden;text-overflow:ellipsis;padding:0 12px;margin:0 -12px}:host(.nx-multiselect) .nx-dropdown-results__option{display:block;padding-left:32px}:host(.nx-multiselect) ::ng-deep .nx-checkbox__label{height:28px;display:flex;align-items:center}:host(.nx-dropdown-item--active),:host:hover{color:#007ab3}@media screen and (-ms-high-contrast:active){:host(.nx-dropdown-item--active),:host:hover{color:highlightText}}:host(.nx-selected) .nx-dropdown-results__option-checkicon{opacity:1}.nx-dropdown-results__option-checkicon{opacity:0;width:16px;height:16px;margin-right:8px}.nx-dropdown-results__option-checkicon nx-icon{font-size:16px}:host-context([data-whatinput=keyboard]).nx-dropdown-item--active .nx-dropdown-results__option .nx-dropdown-results__option-label{border-radius:4px;box-shadow:0 0 0 2px #fff,0 0 0 6px #009de6}:host-context([data-whatinput=keyboard]).nx-multiselect.nx-dropdown-item--active .nx-dropdown-results__option .nx-dropdown-results__option-label{box-shadow:none}:host-context([data-whatinput=keyboard]).nx-multiselect.nx-dropdown-item--active ::ng-deep .nx-checkbox__label{border-radius:4px;box-shadow:0 0 0 2px #fff,0 0 0 6px #009de6}:host(.nx-selected.nx-dropdown-item--active) .nx-dropdown-results__option-label{padding-left:24px;margin-left:-24px}:host ::ng-deep .nx-checkbox__label{padding:0 4px;margin:0 -4px}"]}]}],e.ctorParameters=function(){return[{type:x,decorators:[{type:h.Inject,args:[x]}]},{type:b,decorators:[{type:h.Optional}]},{type:h.ChangeDetectorRef},{type:h.ElementRef}]},e.propDecorators={value:[{type:h.Input,args:["nxValue"]}],onSelectionChange:[{type:h.Output}],containerElement:[{type:h.ViewChild,args:["container"]}]},e}(),k=function(){function e(e){this.templateRef=e}return e.decorators=[{type:h.Directive,args:[{selector:"[nxClosedLabel]"}]}],e.ctorParameters=function(){return[{type:h.TemplateRef}]},e}(),O=function D(e,t){this.source=e,this.value=t},I=function(c){function e(e,t,n,o,i,r,a,s){var l=c.call(this)||this;return l._changeDetectorRef=e,l._elementRef=t,l._ngZone=n,l.formFieldComponent=i,l.ngControl=r,l._parentForm=a,l._parentFormGroup=s,l.readonly=!1,l._disabled=!1,l._focused=!1,l._panelOpen=!1,l.errorState=!1,l._scrollTop=0,l._overlayViewportMargin=16,l.stateChanges=new d.Subject,l._optionIds="",l._tabIndex=0,l.currentFilter="",l._ariaLabel="",l._style="",l._negative=!1,l.showFilter=!1,l.filterPlaceholder="",l.openedChange=new h.EventEmitter,l._openedStream=l.openedChange.pipe(u.filter(function(e){return e}),u.map(function(){})),l._closedStream=l.openedChange.pipe(u.filter(function(e){return!e}),u.map(function(){})),l.filterChanges=new d.Subject,l.valueChange=new h.EventEmitter,l.selectionChange=new h.EventEmitter,l.optionSelectionChanges=d.defer(function(){return l.options?d.merge.apply(void 0,y(l.options.map(function(e){return e.onSelectionChange}))):l._ngZone.onStable.asObservable().pipe(u.take(1),u.switchMap(function(){return l.optionSelectionChanges}))}),l._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"center",overlayX:"start",overlayY:"center"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],l._destroy=new d.Subject,l.valueFormatter=function(e){return null==e?"":e.toString()},l._compareWith=function(e,t){return e===t},l._filterFn=function(e,t){return 0<=t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())},l._onChange=function(){},l._onTouched=function(){},l.ngControl&&(l.ngControl.valueAccessor=l),l.tabIndex=parseInt(o,10)||0,l}return g(e,c),Object.defineProperty(e.prototype,"tabIndex",{get:function(){return this.disabled?-1:this._tabIndex},set:function(e){this._tabIndex=null!=e?e:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this.writeValue(e),this._value=e,this._onChange(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styles",{set:function(e){this._style!==e&&(this._style=e,this._negative=!!this._style.match(/negative/))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closedDropdownLabel",{get:function(){return this._closedDropdownLabel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this.isMultiSelect?this._selectionModel.selected:this._selectionModel.selected[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panelOpen",{get:function(){return this._panelOpen},set:function(e){this._panelOpen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.formFieldComponent?this.formFieldComponent.label:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compareWith",{get:function(){return this._compareWith},set:function(e){if("function"!=typeof e)throw m();this._compareWith=e,this._selectionModel&&this._initializeSelection()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filterFn",{get:function(){return this._filterFn},set:function(e){if("function"!=typeof e)throw m();this._filterFn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focused",{get:function(){return this._focused||this.panelOpen},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementRef",{get:function(){return this._elementRef},enumerable:!0,configurable:!0}),e.prototype.ngDoCheck=function(){this.ngControl&&this.updateErrorState()},e.prototype.ngOnInit=function(){this._selectionModel=new r.SelectionModel(this.isMultiSelect)},e.prototype.ngAfterContentInit=function(){var e=this;this._closedDropdownLabel=this._customClosedDropdownLabel&&this._customClosedDropdownLabel.templateRef||this._defaultClosedDropdownLabel,this._initKeyManager(),this._selectionModel.onChange.pipe(u.takeUntil(this._destroy)).subscribe(function(e){e.added.forEach(function(e){return e.select()}),e.removed.forEach(function(e){return e.deselect()})}),this.options.changes.pipe(u.startWith(null),u.takeUntil(this._destroy)).subscribe(function(){e._resetOptions(),e._initializeSelection()})},e.prototype.ngOnDestroy=function(){this._destroy.next(),this._destroy.complete()},e.prototype.isErrorState=function(e,t){return!!(e&&e.invalid&&(e.touched||t&&t.submitted))},e.prototype.updateErrorState=function(){var e=this.errorState,t=this._parentFormGroup||this._parentForm,n=this.ngControl?this.ngControl.control:null,o=this.isErrorState(n,t);o!==e&&(this.errorState=o,this.stateChanges.next())},e.prototype._initKeyManager=function(){var e=this;this._keyManager=new i.ActiveDescendantKeyManager(this.options).withTypeAhead().withWrap().withVerticalOrientation().withHorizontalOrientation("ltr").skipPredicate(function(e){return e._hidden}),this._keyManager.tabOut.pipe(u.takeUntil(this._destroy)).subscribe(function(){e.closePanel()}),this._keyManager.change.pipe(u.takeUntil(this._destroy)).subscribe(function(){e._panelOpen&&e.panel?e._ngZone.onStable.asObservable().pipe(u.take(1)).subscribe(function(){return e._scrollActiveOptionIntoView()}):e._panelOpen||e.isMultiSelect||!e._keyManager.activeItem||e._keyManager.activeItem._selectViaInteraction()})},e.prototype._resetOptions=function(){var t=this,e=d.merge(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(u.takeUntil(e)).subscribe(function(e){t._onSelect(e.item,e.isUserInput),e.isUserInput&&!t.isMultiSelect&&t._panelOpen&&t.closePanel()}),d.merge.apply(void 0,y(this.options.map(function(e){return e._stateChanges}))).pipe(u.takeUntil(e)).subscribe(function(){setTimeout(function(){t._changeDetectorRef.markForCheck(),t.stateChanges.next()})}),this._setOptionIds()},e.prototype._setOptionIds=function(){this._optionIds=this.options.map(function(e){return e.id}).join(" ")},e.prototype._onSelect=function(e,t){var n=this._selectionModel.isSelected(e);null!=e.value||this.isMultiSelect?(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e),t&&this._keyManager.setActiveItem(e),this.isMultiSelect&&(this._sortValues(),t&&this.focus())):(e.deselect(),this._selectionModel.clear(),this._propagateChanges(e.value)),n!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()},e.prototype._initializeSelection=function(){var e=this;Promise.resolve().then(function(){e._setSelectionByValue(e.ngControl?e.ngControl.value:e._value)})},e.prototype._setSelectionByValue=function(e){var t=this;if(this.isMultiSelect&&e){if(!Array.isArray(e))throw function o(){return Error("Value must be an array in multiselect mode.")}();this._selectionModel.clear(),e.forEach(function(e){return t._selectValue(e)}),this._sortValues()}else{this._selectionModel.clear();var n=this._selectValue(e);n&&this._keyManager.setActiveItem(n)}this._changeDetectorRef.markForCheck()},e.prototype._selectValue=function(n){var o=this,e=this.options.find(function(e){try{return null!=e.value&&o._compareWith(e.value,n)}catch(t){return h.isDevMode()&&console.warn(t),!1}});return e&&this._selectionModel.select(e),e},e.prototype._propagateChanges=function(e){var t=null;t=this.isMultiSelect?this.selected.map(function(e){return e.value}):this.selected?this.selected.value:e,this._value=t,this.valueChange.emit(t),this._onChange(t),this.selectionChange.emit(new O(this,t)),this._changeDetectorRef.markForCheck()},e.prototype._sortValues=function(){if(this.isMultiSelect){var n=this.options.toArray();this._selectionModel.sort(function(e,t){return n.indexOf(e)-n.indexOf(t)}),this.stateChanges.next()}},e.prototype.focus=function(){this._elementRef.nativeElement.focus()},e.prototype.openPanel=function(){!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._panelOpen=!0,this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())},e.prototype.closePanel=function(){var e=this;this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation("ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.openedChange.emit(!1),setTimeout(function(){return e.focus()}))},e.prototype._calculateScrollTop=function(){if(this.panelBody.nativeElement.scrollTop=0,this._scrollTop=0,!this.empty){var e=this._getItemOffset(this._keyManager.activeItem),t=this.panelBody.nativeElement.offsetHeight,n=this.panelBody.nativeElement.getBoundingClientRect().top+t/2,o=this._keyManager.activeItem.containerElement.nativeElement.getBoundingClientRect();n<e&&(this._scrollTop=e-n+(o.height-16)/2,this.panelBody.nativeElement.scrollTop=this._scrollTop)}},e.prototype._scrollActiveOptionIntoView=function(){if(this.panelOpen&&this._keyManager.activeItem){var e=this._keyManager.activeItemIndex||0,t=this._keyManager.activeItem.containerElement.nativeElement.getBoundingClientRect(),n=this._countGroupLabelsBeforeOption(e,this.options,this.groups);this.panelBody.nativeElement.scrollTop=this._getOptionScrollPosition(e+n,t.height,this.panelBody.nativeElement.scrollTop,280)}},e.prototype._countGroupLabelsBeforeOption=function(e,t,n){if(n.length){for(var o=t.toArray(),i=n.toArray(),r=0,a=0;a<e+1;a++)o[a].group&&o[a].group===i[r]&&r++;return r}return 0},e.prototype._getOptionScrollPosition=function(e,t,n,o){var i=e*t+16;this.showFilter&&(i=e*t+this.panel.nativeElement.querySelector(".nx-dropdown__filter").getBoundingClientRect().height);return i<n?i:n+o<i+t?Math.max(0,i-o+t):n},e.prototype._getItemOffset=function(e){return e.containerElement.nativeElement.getBoundingClientRect().top},e.prototype.setDescribedByIds=function(e){this.ariaDescribedby=e.join(" ")},e.prototype.setAriaLabel=function(e){this._ariaLabel=e},e.prototype._getAriaLabel=function(){return this._ariaLabel||(this.formFieldComponent?this.formFieldComponent.label:null)},Object.defineProperty(e.prototype,"empty",{get:function(){return!this._selectionModel||this._selectionModel.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasValue",{get:function(){return this._selectionModel.hasValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldLabelFloat",{get:function(){return this.focused||!this.empty},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){this.options&&this._setSelectionByValue(e)},e.prototype.registerOnChange=function(e){this._onChange=e},e.prototype.registerOnTouched=function(e){this._onTouched=e},e.prototype.setDisabledState=function(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()},e.prototype._handleKeydown=function(e){this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e)},e.prototype._handleClosedKeydown=function(e){var t=e.keyCode,n=t===a.DOWN_ARROW||t===a.UP_ARROW||t===a.LEFT_ARROW||t===a.RIGHT_ARROW;t===a.ENTER||t===a.SPACE||(this.isMultiSelect||e.altKey)&&n?(e.preventDefault(),this.openPanel()):this.isMultiSelect||this.disabled||this._keyManager.onKeydown(e)},e.prototype._handleOpenKeydown=function(e){var t=e.keyCode;if(0<=[a.DOWN_ARROW,a.UP_ARROW,a.HOME,a.END,a.ENTER,a.LEFT_ARROW,a.RIGHT_ARROW,a.SHIFT,a.SPACE,a.TAB].indexOf(t)){var n=t===a.DOWN_ARROW||t===a.UP_ARROW,o=this._keyManager,i=this.options.map(function(e){return e._hidden}).every(function(e){return Boolean(e)});if(t===a.HOME||t===a.END)e.preventDefault(),t===a.HOME?o.setFirstItemActive():o.setLastItemActive();else if(n&&e.altKey)e.preventDefault(),this.closePanel();else if(t===a.ENTER&&o.activeItem&&!i)e.preventDefault(),o.activeItem._selectViaInteraction();else if(t===a.ENTER&&i)e.preventDefault(),this.closePanel();else if(!this.showFilter&&t===a.SPACE&&o.activeItem)e.preventDefault(),o.activeItem._selectViaInteraction();else if(t===a.TAB)this.closePanel();else{var r=o.activeItemIndex;o.onKeydown(e),this.isMultiSelect&&n&&e.shiftKey&&o.activeItem&&o.activeItemIndex!==r&&o.activeItem._selectViaInteraction()}}},e.prototype.formatValue=function(e){return this.valueFormatter(e)},e.prototype._onFilter=function(e){e.preventDefault(),this.currentFilter=e.target.value,this.filterChanges.next(e.target.value),this.options.map(function(e){return e._hidden}).every(function(e){return Boolean(e)})?this._keyManager.setActiveItem(null):this._keyManager.setFirstItemActive()},Object.defineProperty(e.prototype,"triggerValue",{get:function(){return this.empty?"":this.isMultiSelect?this._selectionModel.selected.map(function(e){return e.viewValue}).join(", "):this._selectionModel.selected[0].viewValue},enumerable:!0,configurable:!0}),e.prototype._highlightCorrectOption=function(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))},e.prototype._onAttached=function(){var e=this;this._changeDetectorRef.markForCheck(),this.overlayDir.positionChange.pipe(u.take(1)).subscribe(function(){e.panelBody.nativeElement.focus(),e._keyManager.activeItem&&e._calculateScrollTop(),e._changeDetectorRef.markForCheck(),e.openedChange.emit(!0),e.showFilter&&e.filterInput.nativeElement.focus()})},e.prototype._onFocus=function(){this.disabled||(this._focused=!0,this.stateChanges.next())},e.prototype._onBlur=function(){this._focused=!1,this.filterInput&&this.showFilter&&this._clearFilter(),this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())},Object.defineProperty(e.prototype,"isFilterEmpty",{get:function(){return 0===this.currentFilter.length},enumerable:!0,configurable:!0}),e.prototype._clearFilter=function(){this.filterInput.nativeElement.value="",this.currentFilter="",this.filterChanges.next("")},e.prototype._getAriaActiveDescendant=function(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null},e.decorators=[{type:h.Component,args:[{selector:"nx-dropdown",template:'\n\x3c!-- input and stuff--\x3e\n<div cdkOverlayOrigin\n    #origin="cdkOverlayOrigin"\n    class="nx-dropdown__container"\n    #trigger>\n  <div class="nx-dropdown__rendered">\n    <ng-container *ngTemplateOutlet="closedDropdownLabel"></ng-container>\n  </div>\n  <div class="nx-dropdown__icon">\n    <nx-icon class="nx-dropdown__chevron" name="chevron-down"></nx-icon>\n  </div>\n</div>\n\n<ng-template #defaultClosedDropdownLabel>\n  <div *ngIf="triggerValue">{{ triggerValue }}</div>\n</ng-template>\n\n\x3c!-- overlay --\x3e\n<ng-template\n  cdkConnectedOverlay\n  cdkConnectedOverlayHasBackdrop\n  cdkConnectedOverlayBackdropClass="cdk-overlay-transparent-backdrop"\n  [cdkConnectedOverlayOrigin]="origin"\n  [cdkConnectedOverlayOpen]="panelOpen"\n  [cdkConnectedOverlayPositions]="_positions"\n  [cdkConnectedOverlayMinWidth]="_triggerRect?.width"\n  [cdkConnectedOverlayFlexibleDimensions]="true"\n  [cdkConnectedOverlayViewportMargin]="_overlayViewportMargin"\n  [cdkConnectedOverlayPush]="true"\n  (backdropClick)="closePanel()"\n  (attach)="_onAttached()"\n  (detach)="closePanel()">\n\n  <div class="nx-dropdown__panel"\n      (keydown)="_handleKeydown($event)"\n      #panel>\n    <div class="nx-dropdown__panel-header" *ngIf="label">\n      {{ label }}\n    </div>\n    \n    <div class="nx-dropdown__panel-body" tabindex="-1" #panelBody role="listbox" [attr.aria-activedescendant]="_getAriaActiveDescendant()" [attr.aria-multiselectable]="isMultiSelect">\n        <div class="nx-dropdown__filter" *ngIf="showFilter">\n          <input class="nx-dropdown__filter-input" [class.is-filled]="!isFilterEmpty"  #filterInput type="text" (input)="_onFilter($event)" [placeholder]="filterPlaceholder">\n          <span class="nx-dropdown__filter-icon" *ngIf="!isFilterEmpty" (click)="_clearFilter()">\n            <nx-icon name="close"></nx-icon>\n          </span>\n        </div>\n        <ng-content></ng-content>\n      </div>\n  </div>\n</ng-template>\n',changeDetection:h.ChangeDetectionStrategy.OnPush,providers:[{provide:x,useExisting:e},{provide:p.NxFormfieldControl,useExisting:e}],host:{role:"button","[class.nx-dropdown]":"true","[class.is-filled]":"hasValue","[class.has-focus]":"focused","[class.nx-dropdown--negative]":"_negative","[class.nx-dropdown--disabled]":"disabled","[attr.aria-describedby]":"ariaDescribedby || null","[attr.aria-required]":"required","[attr.aria-label]":"_getAriaLabel()","[attr.aria-haspopup]":'"listbox"',"[attr.aria-expanded]":"panelOpen","[attr.disabled]":"disabled || null","[attr.tabindex]":"tabIndex","(keydown)":"_handleKeydown($event)","(focus)":"_onFocus()","(blur)":"_onBlur()","(click)":"openPanel()"},styles:[":host{display:block}:host:focus{outline:0}:host(.nx-dropdown--negative):focus{font-weight:600}:host(.nx-dropdown--negative){color:#fff}.nx-dropdown__container{display:flex;justify-content:flex-end;cursor:pointer}:host(.nx-dropdown--disabled) .nx-dropdown__container{cursor:not-allowed}.nx-dropdown__rendered{flex:1 1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.nx-dropdown__panel{box-shadow:0 2px 4px rgba(65,65,65,.5);border-radius:4px;background-color:#fff;min-width:100%}.nx-dropdown__panel ::ng-deep .nx-checkbox__label{font-size:20px}.nx-dropdown__panel:focus{outline:0}.nx-dropdown__icon{font-size:24px;line-height:1}.nx-dropdown__panel-header{line-height:16px;font-size:12px;padding:8px 24px;background-color:#ececec;border-top-left-radius:4px;border-top-right-radius:4px;z-index:1;font-weight:600}.nx-dropdown__panel-body{max-height:280px;overflow-y:auto;outline:0}.nx-dropdown__filter{position:relative;padding:16px 32px 24px}.nx-dropdown__filter-input{font-size:20px;border:0;border-bottom:1px solid #d9d9d9;color:#414141;width:100%;outline:0;background-color:transparent;font-weight:300}.nx-dropdown__filter-icon{position:absolute;right:32px;top:16px;cursor:pointer}.nx-dropdown__filter-icon nx-icon{font-size:24px}.nx-dropdown__filter-input.is-filled:focus{color:#007ab3;font-weight:600;border-bottom:1px solid #007ab3;overflow:ellipsis}.nx-dropdown__filter-input.is-filled:focus+.nx-dropdown__filter-icon{color:#007ab3}@media screen and (-ms-high-contrast:active){.nx-dropdown__panel{box-shadow:0 0 0 1px windowText}}"]}]}],e.ctorParameters=function(){return[{type:h.ChangeDetectorRef},{type:h.ElementRef},{type:h.NgZone},{type:String,decorators:[{type:h.Attribute,args:["tabindex"]}]},{type:p.NxFormfieldComponent,decorators:[{type:h.Optional}]},{type:l.NgControl,decorators:[{type:h.Self},{type:h.Optional}]},{type:l.NgForm,decorators:[{type:h.Optional}]},{type:l.FormGroupDirective,decorators:[{type:h.Optional}]}]},e.propDecorators={tabIndex:[{type:h.Input}],_ariaLabel:[{type:h.Input,args:["nxAriaLabel"]}],value:[{type:h.Input,args:["nxValue"]}],disabled:[{type:h.Input,args:["nxDisabled"]}],required:[{type:h.Input,args:["nxRequired"]}],styles:[{type:h.Input,args:["nxStyle"]}],showFilter:[{type:h.Input,args:["nxShowFilter"]}],filterPlaceholder:[{type:h.Input,args:["nxFilterPlaceholder"]}],openedChange:[{type:h.Output}],_openedStream:[{type:h.Output,args:["opened"]}],_closedStream:[{type:h.Output,args:["closed"]}],filterChanges:[{type:h.Output,args:["filterInput"]}],valueChange:[{type:h.Output,args:["nxValueChange"]}],selectionChange:[{type:h.Output}],panel:[{type:h.ViewChild,args:["panel"]}],panelBody:[{type:h.ViewChild,args:["panelBody"]}],trigger:[{type:h.ViewChild,args:["trigger"]}],filterInput:[{type:h.ViewChild,args:["filterInput"]}],overlayDir:[{type:h.ViewChild,args:[s.CdkConnectedOverlay]}],options:[{type:h.ContentChildren,args:[C,{descendants:!0}]}],groups:[{type:h.ContentChildren,args:[b]}],_customClosedDropdownLabel:[{type:h.ContentChild,args:[k]}],_defaultClosedDropdownLabel:[{type:h.ViewChild,args:["defaultClosedDropdownLabel"]}],valueFormatter:[{type:h.Input,args:["nxValueFormatter"]}],compareWith:[{type:h.Input}],filterFn:[{type:h.Input}]},e}(x),M=function(){function e(){}return e.decorators=[{type:h.NgModule,args:[{imports:[n.CommonModule,p.NxFormfieldModule,o.NxCheckboxModule,s.OverlayModule,i.A11yModule,t.NxIconModule,c.ObserversModule],declarations:[I,C,b,k],exports:[I,C,b,k]}]}],e}();e.NxDropdownModule=M,e.NxDropdownSelectChange=O,e.SELECT_PANEL_MAX_HEIGHT=280,e.NxDropdownComponent=I,e.NxDropdownItemChange=v,e.NxDropdownItemComponent=C,e.NxDropdownGroupComponent=b,e.ɵb=k,e.ɵa=x,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=allianz-ngx-ndbx-dropdown.umd.min.js.map