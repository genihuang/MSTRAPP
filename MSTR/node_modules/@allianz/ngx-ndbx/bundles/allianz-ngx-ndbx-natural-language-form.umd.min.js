!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@allianz/ngx-ndbx/input"),require("@allianz/ngx-ndbx/formfield"),require("@allianz/ngx-ndbx/utils"),require("@angular/cdk/overlay"),require("@allianz/ngx-ndbx/popover"),require("@allianz/ngx-ndbx/dropdown"),require("@angular/cdk/coercion"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@allianz/ngx-ndbx/natural-language-form",["exports","@allianz/ngx-ndbx/input","@allianz/ngx-ndbx/formfield","@allianz/ngx-ndbx/utils","@angular/cdk/overlay","@allianz/ngx-ndbx/popover","@allianz/ngx-ndbx/dropdown","@angular/cdk/coercion","rxjs","rxjs/operators","@angular/core","@angular/common"],n):n((e.allianz=e.allianz||{},e.allianz["ngx-ndbx"]=e.allianz["ngx-ndbx"]||{},e.allianz["ngx-ndbx"]["natural-language-form"]={}),e.allianz["ngx-ndbx"].input,e.allianz["ngx-ndbx"].formfield,e.allianz["ngx-ndbx"].utils,e.ng.cdk.overlay,e.allianz["ngx-ndbx"].popover,e.allianz["ngx-ndbx"].dropdown,e.ng.cdk.coercion,e.rxjs,e.rxjs.operators,e.ng.core,e.ng.common)}(this,function(e,n,t,i,o,r,s,a,p,l,d,h){"use strict";var c=function(){function e(e,n,t,o){this.elementRef=e,this._changeDetectorRef=n,this._renderer=t,this._overlay=o,this.subscription=p.Subscription.EMPTY,this.subscriptionValues=p.Subscription.EMPTY,this.hasErrors=!1,this.inputChanges=new p.Subject,this.currentTextWidth=0,this.size="regular"}return e.prototype.ngAfterContentInit=function(){var n=this;this._validateControlChild(),this.subscription=this._control.stateChanges.pipe(l.startWith(null)).subscribe(function(){n.hasErrors=n._control.errorState,n._changeDetectorRef.markForCheck()}),this._control.ngControl?this.subscriptionValues=this._control.ngControl.valueChanges.subscribe(function(e){n.updateCurrentTextWidth(),n.inputChanges.next()}):this.subscriptionValues=this._control.stateChanges.subscribe(function(e){n.updateCurrentTextWidth(),n.inputChanges.next()}),this._control.setAriaLabel(this.label)},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.updateCurrentTextWidth=function(){this.measureCanvas||(this.measureCanvas=this._renderer.createElement("canvas"));var e=this.measureCanvas.getContext("2d"),n=this._control.elementRef,t=window.getComputedStyle(n.nativeElement);e.font=i.getFontShorthand(t);var o=e.measureText(this._control.value).width+parseInt(t.paddingRight,10)+parseInt(t.paddingLeft,10)+1,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect();this.currentTextWidth=Math.max(parseInt(t.minWidth,10),o),this.currentTextWidth=Math.min(this.currentTextWidth,r.width),this._popover.updatePosition()},e.prototype.repositionError=function(){this._popover&&this._popover.updatePosition()},e.prototype._validateControlChild=function(){if(!this._control)throw new Error("NxWordComponent requires an NxFormfieldControl compatible input.")},e.prototype.getConnectedOverlayOrigin=function(){return this.elementRef},Object.defineProperty(e.prototype,"isFocused",{get:function(){return this._control.focused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFilled",{get:function(){return!this._control.empty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasDropdown",{get:function(){return Boolean(this._dropdown)},enumerable:!0,configurable:!0}),e.decorators=[{type:d.Component,args:[{selector:"nx-word",template:'<div\n  class="nx-word__input-wrapper"\n  [nxPopoverTriggerFor]="popoverHover"\n  nxPopoverTrigger=\'manual\'\n  nxPopoverCloseable="false"\n  nxPopoverDirection="top"\n  [nxPopoverShow]="hasErrors && _errorChildren.length > 0">\n\n  \x3c!-- We only allow formfield controls here --\x3e\n  <div *ngIf="!hasDropdown" class="nx-word__inner-wrapper">\n    <ng-content select="[nxInput]"></ng-content>\n  </div>\n  <ng-content select="nx-dropdown"></ng-content>\n</div>\n\n<nx-popover #popoverHover>\n  <ng-content select="[nxError]"></ng-content>\n</nx-popover>\n',host:{"[class.size-short]":'size == "short"',"[class.size-regular]":'size == "regular"',"[class.size-long]":'size == "long"',"[class.has-error]":"hasErrors","[class.is-focused]":"isFocused","[class.is-filled]":"isFilled","[class.has-dropdown]":"hasDropdown"},changeDetection:d.ChangeDetectionStrategy.OnPush,styles:[":host{display:inline-block;position:relative;font-weight:400;text-align:center;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;width:100%}:host .nx-word__inner-wrapper{border-bottom:2px solid #d9d9d9}:host.size-short{min-width:80px}:host.size-regular{min-width:152px}:host.size-long{min-width:360px}@media (max-width:991px){:host.size-long{min-width:280px}}@media (max-width:703px){:host.size-long{min-width:248px}}:host ::ng-deep .c-input{display:inline-block;text-align:inherit;font-size:inherit;line-height:inherit;background:0 0;color:inherit;border:none;outline:0;margin:0;width:100%;max-width:100%;height:auto;box-shadow:none;padding:0 8px}:host ::ng-deep .c-input.is-focused{outline:0;box-shadow:none;border-bottom-width:2px}:host ::ng-deep .c-input.is-filled,:host ::ng-deep .c-input.is-focused{color:#006192;font-weight:400}:host ::ng-deep .c-input.is-disabled{cursor:not-allowed}:host ::ng-deep .c-input::-ms-clear{display:none}:host ::ng-deep nx-dropdown{position:relative;border-bottom:2px solid #d9d9d9}:host ::ng-deep nx-dropdown .nx-dropdown__container{font-size:inherit;margin-bottom:-2px}:host ::ng-deep nx-dropdown.is-filled{border-color:#007ab3;color:#006192}:host ::ng-deep nx-dropdown .nx-dropdown__icon{line-height:inherit}:host ::ng-deep .nx-word__input-wrapper{width:100%}:host(.is-filled) .nx-word__inner-wrapper,:host(.is-focused) .nx-word__inner-wrapper{border-color:#007ab3}:host(.has-error) .nx-word__inner-wrapper{border-color:#dc3149}:host.has-error ::ng-deep nx-dropdown{color:#dc3149;border-color:#dc3149}:host.has-error ::ng-deep .c-input.has-error{color:#dc3149}:host-context(.is-negative) ::ng-deep .nx-dropdown,:host-context(.is-negative) ::ng-deep nx-dropdown,:host-context(.is-negative) ::ng-deep nx-dropdown.is-filled{border-color:#fff;color:#fff}:host-context(.is-negative) ::ng-deep .c-input{color:#fff}:host-context(.is-negative) .nx-word__inner-wrapper{border-color:#fff}.nx-word__inner-wrapper{height:52px}@media (max-width:991px){:host ::ng-deep nx-dropdown .nx-dropdown__container{font-size:26px}.nx-word__inner-wrapper{height:36px}}:host-context(.nx-natural-language-form--small) .nx-word__inner-wrapper{height:36px}:host-context(.nx-natural-language-form--small) ::ng-deep nx-dropdown .nx-dropdown__container{margin-bottom:2px}"]}]}],e.ctorParameters=function(){return[{type:d.ElementRef},{type:d.ChangeDetectorRef},{type:d.Renderer2},{type:o.Overlay}]},e.propDecorators={_control:[{type:d.ContentChild,args:[t.NxFormfieldControl]}],_errorChildren:[{type:d.ContentChildren,args:[t.NxFormfieldErrorDirective]}],_popover:[{type:d.ViewChild,args:[r.NxPopoverTriggerDirective]}],_dropdown:[{type:d.ContentChild,args:[s.NxDropdownComponent]}],currentTextWidth:[{type:d.HostBinding,args:["style.width.px"]}],size:[{type:d.Input,args:["nxSize"]}],label:[{type:d.Input,args:["nxLabel"]}]},e}();function u(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,r,i=t.call(e),s=[];try{for(;(void 0===n||0<n--)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(t=i["return"])&&t.call(i)}finally{if(r)throw r.error}}return s}var g=function(){function e(e){this._changeDetectorRef=e,this._negative=!1,this.resizeEvent$=new p.Subject,this.updatePopoversSubscription=p.Subscription.EMPTY,this._size="large"}return Object.defineProperty(e.prototype,"negative",{get:function(){return this._negative},set:function(e){this._negative=a.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(e){this._size=e,this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),e.prototype.onResize=function(e){this.resizeEvent$.next()},e.prototype.ngAfterContentInit=function(){var e=this,n=this._words.map(function(e){return e.inputChanges}),t=p.merge.apply(void 0,function o(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(u(arguments[n]));return e}(n));this.updatePopoversSubscription=t.subscribe(function(){e.updatePositionPopovers()}),this.resizeObservable=this.resizeEvent$.pipe(l.throttleTime(500),l.delay(100)),this.resizeObservable.subscribe(function(){return e.resizeWords()})},e.prototype.resizeWords=function(){this._words.forEach(function(e){e.updateCurrentTextWidth()})},e.prototype.ngOnDestroy=function(){this.updatePopoversSubscription.unsubscribe()},e.prototype.updatePositionPopovers=function(){this._words&&this._words.forEach(function(e){e.repositionError()})},e.decorators=[{type:d.Component,args:[{selector:"nx-natural-language-form",template:'<div class="nx-natural-language-form__wrapper">\n    <ng-content></ng-content>\n</div>',changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.is-negative]":"negative","[class.nx-natural-language-form--small]":'size === "small"',"[class.nx-natural-language-form--large]":'size === "large"'},styles:[":host{display:block;padding-top:72px;padding-bottom:80px;color:#414141;font-weight:300;font-size:40px;line-height:52px}:host ::ng-deep .c-input{font-size:inherit;line-height:inherit}:host ::ng-deep nx-word+nx-word{margin-left:2px}:host.is-negative{color:#fff}@media (max-width:991px){:host{font-size:26px;line-height:36px}}@media (max-width:703px){:host{font-size:26px}}.nx-natural-language-form__wrapper{display:flex;flex-wrap:wrap}.nx-natural-language-form__wrapper>::ng-deep *{margin-bottom:8px}:host(.nx-natural-language-form--small){font-size:26px;line-height:32px;letter-spacing:.3px}:host(.nx-natural-language-form--small) ::ng-deep .c-input{font-size:inherit;line-height:inherit}"]}]}],e.ctorParameters=function(){return[{type:d.ChangeDetectorRef}]},e.propDecorators={_words:[{type:d.ContentChildren,args:[c]}],negative:[{type:d.Input,args:["nxNegative"]}],size:[{type:d.Input}],onResize:[{type:d.HostListener,args:["window:orientationchange",["$event"]]},{type:d.HostListener,args:["window:resize",["$event"]]}]},e}(),x=function(){function e(){}return e.decorators=[{type:d.NgModule,args:[{imports:[h.CommonModule,n.NxInputModule,r.NxPopoverModule],declarations:[g,c],exports:[g,c]}]}],e}();e.NxNaturalLanguageFormModule=x,e.NxNaturalLanguageFormComponent=g,e.NxWordComponent=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=allianz-ngx-ndbx-natural-language-form.umd.min.js.map