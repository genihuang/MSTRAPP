!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/coercion"),require("@angular/cdk/portal"),require("@angular/platform-browser"),require("rxjs/operators"),require("rxjs"),require("@angular/core"),require("@angular/cdk/overlay"),require("@angular/common"),require("@allianz/ngx-ndbx/icon")):"function"==typeof define&&define.amd?define("@allianz/ngx-ndbx/popover",["exports","@angular/cdk/coercion","@angular/cdk/portal","@angular/platform-browser","rxjs/operators","rxjs","@angular/core","@angular/cdk/overlay","@angular/common","@allianz/ngx-ndbx/icon"],t):t((e.allianz=e.allianz||{},e.allianz["ngx-ndbx"]=e.allianz["ngx-ndbx"]||{},e.allianz["ngx-ndbx"].popover={}),e.ng.cdk.coercion,e.ng.cdk.portal,e.ng.platformBrowser,e.rxjs.operators,e.rxjs,e.ng.core,e.ng.cdk.overlay,e.ng.common,e.allianz["ngx-ndbx"].icon)}(this,function(e,t,o,r,n,i,s,a,p,l){"use strict";function c(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)s.push(r.value)}catch(a){n={error:a}}finally{try{r&&!r.done&&(o=i["return"])&&o.call(i)}finally{if(n)throw n.error}}return s}var h=0,f=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top",offsetX:0,offsetY:16},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",offsetX:0,offsetY:-16},{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetX:0,offsetY:16},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top",offsetX:0,offsetY:16},{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:16,offsetY:0},{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:-16,offsetY:0},{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetX:0,offsetY:-16},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",offsetX:0,offsetY:-16}],g=function(){function e(e,t,o,r){this.overlay=e,this.elementRef=t,this.viewContainerRef=o,this.eventManager=r,this._destroyed=new i.Subject,this._show=!1,this._closeable=null,this.id="nx-popover-"+h++,this.changeShow=new s.EventEmitter,this.direction="right",this.popoverInitialVisible=!1,this.visibleChange=new s.EventEmitter,this.modal=!1,this.trigger="click",this.scrollStrategy="close",this._documentClickObservable=i.fromEvent(document,"click")}return Object.defineProperty(e.prototype,"show",{get:function(){return this._show},set:function(e){e=t.coerceBooleanProperty(e),this._show!==e&&(this._show=e,this._show?this.openPopover():this.closePopover(),this.changeShow.emit(this._show))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closeable",{get:function(){return this._closeable},set:function(e){this._closeable=t.coerceBooleanProperty(e),this.popover&&(this.popover.showCloseButton=this.isCloseable())},enumerable:!0,configurable:!0}),e.prototype.onMouseEnter=function(){"hover"===this.trigger&&this.openPopover()},e.prototype.onMouseExit=function(){"hover"===this.trigger&&this.closePopover()},e.prototype.ngOnInit=function(){this.popover.showCloseButton=this.isCloseable()},e.prototype.ngAfterViewInit=function(){var e=this;this.popover.id=this.id,this.eventManager.addGlobalEventListener("window","keyup.esc",function(){e.closePopover()}),this.popover.closeButtonClick.pipe(n.takeUntil(this._destroyed)).subscribe(function(){e.closePopover()}),(this.popoverInitialVisible||this._show)&&this.openPopover()},e.prototype.ngOnDestroy=function(){this.closePopover(),this._destroyed.next(),this._destroyed.complete()},Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.overlayRef&&this.createOverlay().hasAttached()},enumerable:!0,configurable:!0}),e.prototype.isCloseable=function(){return"click"===this.trigger&&null===this._closeable||this._closeable},e.prototype.updatePosition=function(){this._positionStrategy&&this._positionStrategy.apply()},e.prototype.handleClick=function(){"click"===this.trigger&&(this.isOpen?this.closePopover():this.openPopover())},e.prototype.open=function(){this.show=!0},e.prototype.close=function(){this.show=!1},e.prototype.toggle=function(){this.show=!this.show},e.prototype.openPopover=function(){this.createOverlay().hasAttached()||(this._embeddedViewRef=this.createOverlay().attach(this.portal),this.modal||"click"!==this.trigger||this.waitForClose())},e.prototype.closePopover=function(){this.overlayRef&&(this.overlayRef.detach(),this._embeddedViewRef=null)},e.prototype.createOverlay=function(){if(!this.overlayRef){this.portal=new o.TemplatePortal(this.popover.templateRef,this.viewContainerRef);var e=new a.OverlayConfig;e.positionStrategy=this.getPosition(),this._positionStrategy=e.positionStrategy,"reposition"===this.scrollStrategy?e.scrollStrategy=this.overlay.scrollStrategies.reposition():e.scrollStrategy=this.overlay.scrollStrategies.close(),e.scrollStrategy.enable(),this.modal&&"click"===this.trigger&&(e.hasBackdrop=!0),this.overlayRef=this.overlay.create(e),this.subscribeToPositions(e.positionStrategy),this._subscribeToDetach(),this.modal&&this._subscribeToBackdropClick()}return this.overlayRef},e.prototype.subscribeToPositions=function(e){var o=this;e.positionChanges.pipe(n.takeUntil(this._destroyed)).subscribe(function(e){var t=e.connectionPair;o.positionOverlay(t),o.positionArrow(t),o._embeddedViewRef&&!o._embeddedViewRef.destroyed&&o._embeddedViewRef.detectChanges()})},e.prototype._subscribeToBackdropClick=function(){var t=this;this.overlayRef.backdropClick().pipe(n.takeUntil(this._destroyed)).subscribe(function(e){t.closePopover()})},e.prototype._subscribeToDetach=function(){var e=this;this.overlayRef.detachments().pipe(n.takeUntil(this._destroyed)).subscribe(function(){e.popover.emitClosedEvent()})},e.prototype.waitForClose=function(){var t=this;return this._documentClickObservable.pipe(n.map(function(e){return e.target}),n.filter(function(e){return!t.elementRef.nativeElement.contains(e)}),n.takeUntil(this.popover.closed)).subscribe(function(){t.closePopover()})},e.prototype.positionOverlay=function(e){"end"===e.originX&&"start"===e.overlayX?this.popover.direction="right":"bottom"===e.originY&&"top"===e.overlayY?this.popover.direction="bottom":"start"===e.originX&&"end"===e.overlayX?this.popover.direction="left":"top"===e.originY&&"bottom"===e.overlayY&&(this.popover.direction="top")},e.prototype.positionArrow=function(e){var t=this.elementRef.nativeElement.getBoundingClientRect().left+this.elementRef.nativeElement.getBoundingClientRect().width/2-(this.overlayRef.overlayElement.parentElement.offsetLeft+this.overlayRef.overlayElement.offsetLeft);if(e.originX===e.overlayX){var o={};o.left=t+"px",this.popover.arrowStyle=o}"bottom"!==e.originY&&"top"!==e.originY||"center"!==e.overlayX||(this.popover.arrowStyle={left:t+"px"}),"end"!==e.originX&&"start"!==e.originX||"center"!==e.overlayY||(this.popover.arrowStyle={top:"50%"})},e.prototype.getPosition=function(){var e,t=0,o=0;return"top"===this.direction?(e=[{overlayX:"center",overlayY:"bottom",originX:"center",originY:"top"}],t=0,o=-20):"right"===this.direction?(e=[{overlayX:"start",overlayY:"center",originX:"end",originY:"center"}],t=20,o=0):"bottom"===this.direction?(e=[{overlayX:"center",overlayY:"top",originX:"center",originY:"bottom"}],t=0,o=20):"left"===this.direction&&(e=[{overlayX:"end",overlayY:"center",originX:"start",originY:"center"}],t=-20,o=0),this.overlay.position().flexibleConnectedTo(this.elementRef).withPositions(function r(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}(e,f)).withDefaultOffsetX(t).withDefaultOffsetY(o)},e.decorators=[{type:s.Directive,args:[{selector:"[nxPopoverTriggerFor]",exportAs:"nxPopoverTrigger",host:{"(click)":"handleClick()","aria-haspopup":"true","[attr.aria-expanded]":"isOpen","[attr.aria-describedby]":"isOpen ? id : null"}}]}],e.ctorParameters=function(){return[{type:a.Overlay},{type:s.ElementRef},{type:s.ViewContainerRef},{type:r.EventManager}]},e.propDecorators={changeShow:[{type:s.Output,args:["nxPopoverShowChange"]}],show:[{type:s.Input,args:["nxPopoverShow"]}],closeable:[{type:s.Input,args:["nxPopoverCloseable"]}],popover:[{type:s.Input,args:["nxPopoverTriggerFor"]}],direction:[{type:s.Input,args:["nxPopoverDirection"]}],popoverInitialVisible:[{type:s.Input,args:["nxPopoverInitialVisible"]}],visibleChange:[{type:s.Input,args:["nxPopoverVisibleChange"]}],modal:[{type:s.Input,args:["nxPopoverModal"]}],trigger:[{type:s.Input,args:["nxPopoverTrigger"]}],scrollStrategy:[{type:s.Input,args:["nxPopoverScrollStrategy"]}],onMouseEnter:[{type:s.HostListener,args:["mouseenter"]}],onMouseExit:[{type:s.HostListener,args:["mouseleave"]},{type:s.HostListener,args:["touchstart"]}]},e}(),d=function(){function e(e){this._template=e}return e.decorators=[{type:s.Directive,args:[{selector:"ng-template[nxPopoverContent]"}]}],e.ctorParameters=function(){return[{type:s.TemplateRef}]},e}(),u=function(){function e(){this.closed=new s.EventEmitter,this.closeButtonClick=new i.Subject,this.showCloseButton=!1,this.arrowStyle={}}return e.prototype.ngOnDestroy=function(){this.closed.complete()},e.prototype.emitButtonClick=function(){this.closeButtonClick.next()},e.prototype.emitClosedEvent=function(){this.closed.emit()},Object.defineProperty(e.prototype,"classList",{get:function(){if(this.direction)return["nx-popover--"+this.direction]},enumerable:!0,configurable:!0}),e.decorators=[{type:s.Component,args:[{selector:"nx-popover",template:'<ng-template>\n  <div [ngClass]="classList" role="tooltip" aria-hidden="false">\n    <div class="nx-popover__content">\n        <div class="nx-popover__arrow" [ngStyle]="arrowStyle">\n          </div>\n      <span aria-hidden="true" class="nx-popover__close-icon" (click)="emitButtonClick()"\n            *ngIf="showCloseButton">\n        <nx-icon name="close"></nx-icon>\n      </span>\n      <span [id]="id">\n        <ng-content></ng-content>\n        <ng-container [ngTemplateOutlet]="_lazyContent?._template"></ng-container>\n      </span>\n    </div>\n  </div>\n</ng-template>\n',changeDetection:s.ChangeDetectionStrategy.OnPush,exportAs:"nxPopover",styles:[".nx-popover__content{background-color:#fff;border:1px solid #d9d9d9;border-radius:4px;box-shadow:0 2px 4px rgba(65,65,65,.5);padding:23px;display:inline-block;font-size:16px}.nx-popover__close-icon{position:absolute;top:4px;right:4px;cursor:pointer;font-size:16px;line-height:16px}[data-whatintent=mouse] .nx-popover__content:focus{outline:0}.nx-popover__arrow{width:12px;height:12px;background-color:inherit;position:absolute;-webkit-transform:translate(-50%,0);transform:translate(-50%,0);border-top:1px solid #d9d9d9;border-left:1px solid #d9d9d9}.nx-popover--top .nx-popover__arrow{-webkit-transform:translate(-50%,0) rotate(225deg);transform:translate(-50%,0) rotate(225deg);bottom:-5px;box-shadow:2px 2px 1px 1px #fff,-2px -2px 4px rgba(65,65,65,.5)}.nx-popover--right .nx-popover__arrow{-webkit-transform:translate(0,-50%) rotate(-45deg);transform:translate(0,-50%) rotate(-45deg);left:-5px}.nx-popover--bottom .nx-popover__arrow{-webkit-transform:translate(-50%,0) rotate(45deg);transform:translate(-50%,0) rotate(45deg);top:-5px}.nx-popover--left .nx-popover__arrow{-webkit-transform:translate(0,-50%) rotate(135deg);transform:translate(0,-50%) rotate(135deg);right:-5px}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={templateRef:[{type:s.ViewChild,args:[s.TemplateRef]}],_lazyContent:[{type:s.ContentChild,args:[d]}],closed:[{type:s.Output,args:["nxClosed"]}]},e}(),v=function(){function e(){}return e.decorators=[{type:s.NgModule,args:[{imports:[p.CommonModule,a.OverlayModule,l.NxIconModule],declarations:[g,u,d],exports:[g,u,d]}]}],e}();e.NxPopoverModule=v,e.NxPopoverComponent=u,e.NxPopoverTriggerDirective=g,e.NxPopoverContentDirective=d,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=allianz-ngx-ndbx-popover.umd.min.js.map