/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { mapClassNames } from '@allianz/ngx-ndbx/utils';
import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, Input, Output, ChangeDetectorRef } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { TableDataSource } from './tabledata-source';
/** @type {?} */
var MAPPING = {
    light: 'nx-table--light',
    border: 'nx-table--light nx-table--with-border'
};
/** @type {?} */
var DEFAULT_CLASSES = ['nx-table '];
var NxDynamicTableComponent = /** @class */ (function () {
    function NxDynamicTableComponent(el, _changeDetectorRef) {
        this.el = el;
        this._changeDetectorRef = _changeDetectorRef;
        this._tableStyles = '';
        this._dataChange = new BehaviorSubject([]);
        this._classNames = mapClassNames('', DEFAULT_CLASSES, MAPPING);
        /**
         * An event is dispatched when a row is clicked.
         */
        this.nxRowClick = new EventEmitter();
    }
    Object.defineProperty(NxDynamicTableComponent.prototype, "data", {
        get: /**
         * @return {?}
         */
        function () {
            return this._data;
        },
        /** Sets the data that it will show in the table. */
        set: /**
         * Sets the data that it will show in the table.
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._data = value
                .filter((/**
             * @param {?} element
             * @return {?}
             */
            function (element) { return element; }));
            // If user dont pass displayedColumns the table will show all data and the name of columns will be the key of data
            if (!this._displayedColumns) {
                /** @type {?} */
                var keys_1 = [];
                /** @type {?} */
                var cArray_1 = [];
                // For catch keys of data Objects and assing title, key and type string by default to displayedColumns
                this._data
                    .forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                function (element) {
                    for (var key in element) {
                        if (keys_1.indexOf(key) === -1) {
                            keys_1.push(key);
                            cArray_1.push({ title: key, key: key, type: 'string' });
                        }
                    }
                }));
                this._columnKeys = keys_1;
                this._displayedColumns = cArray_1;
                // need to call markForCheck as the setter changes displayedColumns here
                // sidenote: isn't needed for the data itself as it gets passed to the cdk-table
                // by the datasource observable
                this._changeDetectorRef.markForCheck();
            }
            this._dataChange.next(this._data);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NxDynamicTableComponent.prototype, "displayedColumns", {
        get: /**
         * @return {?}
         */
        function () {
            return this._displayedColumns;
        },
        /** Sets the name order and type of columns. */
        set: /**
         * Sets the name order and type of columns.
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._displayedColumns = value;
            this._columnKeys = value.map((/**
             * @param {?} column
             * @return {?}
             */
            function (column) { return column.key; }));
            this._changeDetectorRef.markForCheck();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NxDynamicTableComponent.prototype, "styles", {
        /** @deprecated The default and light header styling will be removed.
         * @deletion-target 8.0.0
        */
        set: /**
         * @deprecated The default and light header styling will be removed.
         * \@deletion-target 8.0.0
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (this._tableStyles === value) {
                return;
            }
            this._classNames = mapClassNames(value, DEFAULT_CLASSES, MAPPING);
            this._tableStyles = value;
            this._changeDetectorRef.markForCheck();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NxDynamicTableComponent.prototype, "dataSource", {
        /** @docs-private */
        get: /**
         * \@docs-private
         * @return {?}
         */
        function () {
            return this._dataSource;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NxDynamicTableComponent.prototype, "classNames", {
        /** @docs-private */
        get: /**
         * \@docs-private
         * @return {?}
         */
        function () {
            return this._classNames;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NxDynamicTableComponent.prototype, "columnKeys", {
        /** @docs-private */
        get: /**
         * \@docs-private
         * @return {?}
         */
        function () {
            return this._columnKeys;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NxDynamicTableComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (!this._data) {
            this._data = [];
            this._dataChange.next(this._data);
        }
        this._dataSource = new TableDataSource(this._dataChange);
    };
    /** @docs-private */
    /**
     * \@docs-private
     * @param {?} row
     * @return {?}
     */
    NxDynamicTableComponent.prototype.handleRowClick = /**
     * \@docs-private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        this.nxRowClick.emit(row);
    };
    /** @docs-private */
    /**
     * \@docs-private
     * @param {?} element
     * @return {?}
     */
    NxDynamicTableComponent.prototype.isNumeric = /**
     * \@docs-private
     * @param {?} element
     * @return {?}
     */
    function (element) {
        if (element.type === 'numeric') {
            return true;
        }
        return false;
    };
    NxDynamicTableComponent.decorators = [
        { type: Component, args: [{
                    selector: 'nx-dynamic-table',
                    template: "<div class=\"nx-table__container\" *ngIf=\"data && data.length > 0\">\n  <div class=\"nx-table__scroll\">\n    <cdk-table [dataSource]=\"dataSource\" [ngClass]=\"classNames\">\n      <!-- Column Definition -->\n      <ng-container *ngFor=\"let element of displayedColumns\" cdkColumnDef=\"{{element.key}}\">\n        <cdk-header-cell *cdkHeaderCellDef class=\"nx-table__header-cell\"\n                         [ngClass]=\"{'nx-table__header-cell--number': isNumeric(element) }\">\n          <div class=\"nx-table__header-title--block\">\n            <span class=\"nx-table__header-title\"> {{element.title}}</span>\n          </div>\n        </cdk-header-cell>\n        <cdk-cell *cdkCellDef=\"let row\" class=\"nx-table__cell\"\n                  [ngClass]=\"{'nx-table__cell--number': isNumeric(element) }\" [innerHTML]=\"row[element.key]\"></cdk-cell>\n      </ng-container>\n\n      <!-- Header and Row Declarations -->\n      <cdk-header-row *cdkHeaderRowDef=\"columnKeys\" class=\"nx-table__header-row\"></cdk-header-row>\n      <cdk-row *cdkRowDef=\"let row; columns: columnKeys\" class=\"nx-table__row\"\n               (dblclick)=\"handleRowClick(row)\"></cdk-row>\n\n    </cdk-table>\n  </div>\n</div>\n<div class=\"nx-table__appendix\" *ngIf=\"data.length === 0\">\n  <ng-content></ng-content>\n</div>\n",
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    styles: [".nx-table{border-top:2px solid #d9d9d9;border-bottom:2px solid #414141;font-size:16px;text-align:left;width:100%;line-height:24px;color:#414141;display:table}.nx-table--light.nx-table{border-top:1px solid #d9d9d9}.nx-table__container{margin:32px 0}.nx-table__scroll{max-width:100%;overflow:hidden;overflow-x:auto}.nx-table__header-cell{background-color:#d9d9d9;border:1px solid #fff;border-right:none;color:#414141;padding:21px 16px 23px;position:relative;font-size:16px;line-height:24px;font-weight:700}.nx-table__header-row .nx-table__header-cell:last-child{border-right:1px solid #fff}.nx-table__header-row{background-color:#d9d9d9;border-spacing:1px none}.nx-table--light .nx-table__header-row{background-color:#fff;border-bottom:2px solid #414141;border-top:1px solid #d9d9d9}.nx-table__header-cell--number{display:flex;position:relative}.nx-table__header-cell--number .nx-table__header-title--block{justify-content:flex-end}.nx-table__cell{padding:24px 16px;vertical-align:top}.nx-table__cell--number,.nx-table__header-cell--number{text-align:right}.nx-table__row{background-color:#fff}.nx-table__header-row,.nx-table__row{display:table-row;vertical-align:inherit;border-color:inherit}.nx-table__row:nth-child(2n+1){background-color:#ececec}.nx-table--light.nx-table--with-border .nx-table__row{background-color:#fff}.nx-table--light .nx-table__header-cell{background-color:#fff;border:none;border-bottom:2px solid #414141;padding-top:23px;padding-bottom:22px}.nx-table--light.nx-table--with-border .nx-table__cell{padding-bottom:23px;border-bottom:1px solid #d9d9d9}.nx-table__row:last-child .nx-table__cell{padding-bottom:22px;border-bottom:none}.nx-table__cell,.nx-table__header-cell{display:table-cell;vertical-align:inherit}"]
                }] }
    ];
    /** @nocollapse */
    NxDynamicTableComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: ChangeDetectorRef }
    ]; };
    NxDynamicTableComponent.propDecorators = {
        data: [{ type: Input, args: ['nxData',] }],
        displayedColumns: [{ type: Input, args: ['nxDisplayedColumns',] }],
        styles: [{ type: Input, args: ['nxType',] }],
        nxRowClick: [{ type: Output }]
    };
    return NxDynamicTableComponent;
}());
export { NxDynamicTableComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._tableStyles;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._dataChange;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._dataSource;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._data;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._classNames;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._displayedColumns;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._columnKeys;
    /**
     * An event is dispatched when a row is clicked.
     * @type {?}
     */
    NxDynamicTableComponent.prototype.nxRowClick;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    NxDynamicTableComponent.prototype._changeDetectorRef;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy10YWJsZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYWxsaWFuei9uZ3gtbmRieC8iLCJzb3VyY2VzIjpbImR5bmFtaWMtdGFibGUvZHluYW1pYy10YWJsZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN2SSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBR3ZDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQzs7SUFFL0MsT0FBTyxHQUFHO0lBQ2QsS0FBSyxFQUFFLGlCQUFpQjtJQUN4QixNQUFNLEVBQUUsdUNBQXVDO0NBQ2hEOztJQUNLLGVBQWUsR0FBRyxDQUFFLFdBQVcsQ0FBRTtBQUV2QztJQXVGRSxpQ0FBb0IsRUFBYyxFQUFVLGtCQUFxQztRQUE3RCxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFtQjtRQS9FekUsaUJBQVksR0FBVyxFQUFFLENBQUM7UUFDMUIsZ0JBQVcsR0FBMkIsSUFBSSxlQUFlLENBQVEsRUFBRSxDQUFDLENBQUM7UUFHckUsZ0JBQVcsR0FBVyxhQUFhLENBQUMsRUFBRSxFQUFFLGVBQWUsRUFBRSxPQUFPLENBQUMsQ0FBQzs7OztRQTREaEUsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7SUFlMkMsQ0FBQztJQXRFdEYsc0JBQ0kseUNBQUk7Ozs7UUF5QlI7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDcEIsQ0FBQztRQTdCRCxvREFBb0Q7Ozs7OztRQUNwRCxVQUNTLEtBQVk7WUFDbkIsSUFBSSxDQUFD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QUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzNELENBQUM7SUFFRCxvQkFBb0I7Ozs7OztJQUNwQixnREFBYzs7Ozs7SUFBZCxVQUFlLEdBQVc7UUFDeEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUVELG9CQUFvQjs7Ozs7O0lBQ3BCLDJDQUFTOzs7OztJQUFULFVBQVUsT0FBMkI7UUFDbkMsSUFBSSxPQUFPLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTtZQUM5QixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDOztnQkE1R0YsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxrQkFBa0I7b0JBQzVCLDh5Q0FBNkM7b0JBQzdDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNOztpQkFFaEQ7Ozs7Z0JBakI0QyxVQUFVO2dCQUF1QyxpQkFBaUI7Ozt1QkE2QjVHLEtBQUssU0FBQyxRQUFRO21DQStCZCxLQUFLLFNBQUMsb0JBQW9CO3lCQWExQixLQUFLLFNBQUMsUUFBUTs2QkFXZCxNQUFNOztJQXNDVCw4QkFBQztDQUFBLEFBOUdELElBOEdDO1NBeEdZLHVCQUF1Qjs7Ozs7O0lBRWxDLCtDQUFrQzs7Ozs7SUFDbEMsOENBQTZFOzs7OztJQUM3RSw4Q0FBNEM7Ozs7O0lBQzVDLHdDQUFxQjs7Ozs7SUFDckIsOENBQTBFOzs7OztJQUMxRSxvREFBZ0Q7Ozs7O0lBQ2hELDhDQUE4Qjs7Ozs7SUEwRDlCLDZDQUEwQzs7Ozs7SUFlOUIscUNBQXNCOzs7OztJQUFFLHFEQUE2QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1hcENsYXNzTmFtZXMgfSBmcm9tICdAYWxsaWFuei9uZ3gtbmRieC91dGlscyc7XG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dCwgQ2hhbmdlRGV0ZWN0b3JSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQgeyBOeERpc3BsYXllZENvbHVtbnMgfSBmcm9tICcuL2Rpc3BsYXllZENvbHVtbnMnO1xuaW1wb3J0IHsgVGFibGVEYXRhU291cmNlIH0gZnJvbSAnLi90YWJsZWRhdGEtc291cmNlJztcblxuY29uc3QgTUFQUElORyA9IHtcbiAgbGlnaHQ6ICdueC10YWJsZS0tbGlnaHQnLFxuICBib3JkZXI6ICdueC10YWJsZS0tbGlnaHQgbngtdGFibGUtLXdpdGgtYm9yZGVyJ1xufTtcbmNvbnN0IERFRkFVTFRfQ0xBU1NFUyA9IFsgJ254LXRhYmxlICcgXTtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbngtZHluYW1pYy10YWJsZScsXG4gIHRlbXBsYXRlVXJsOiAnLi9keW5hbWljLXRhYmxlLmNvbXBvbmVudC5odG1sJyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIHN0eWxlVXJsczogWyAnLi9keW5hbWljLXRhYmxlLmNvbXBvbmVudC5zY3NzJyBdLFxufSlcbmV4cG9ydCBjbGFzcyBOeER5bmFtaWNUYWJsZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgcHJpdmF0ZSBfdGFibGVTdHlsZXM6IHN0cmluZyA9ICcnO1xuICBwcml2YXRlIF9kYXRhQ2hhbmdlOiBCZWhhdmlvclN1YmplY3Q8YW55W10+ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxhbnlbXT4oW10pO1xuICBwcml2YXRlIF9kYXRhU291cmNlOiBUYWJsZURhdGFTb3VyY2UgfCBudWxsO1xuICBwcml2YXRlIF9kYXRhOiBhbnlbXTtcbiAgcHJpdmF0ZSBfY2xhc3NOYW1lczogc3RyaW5nID0gbWFwQ2xhc3NOYW1lcygnJywgREVGQVVMVF9DTEFTU0VTLCBNQVBQSU5HKTtcbiAgcHJpdmF0ZSBfZGlzcGxheWVkQ29sdW1uczogTnhEaXNwbGF5ZWRDb2x1bW5zW107XG4gIHByaXZhdGUgX2NvbHVtbktleXM6IHN0cmluZ1tdO1xuXG4gIC8qKiBTZXRzIHRoZSBkYXRhIHRoYXQgaXQgd2lsbCBzaG93IGluIHRoZSB0YWJsZS4gKi9cbiAgQElucHV0KCdueERhdGEnKVxuICBzZXQgZGF0YSh2YWx1ZTogYW55W10pIHtcbiAgICB0aGlzLl9kYXRhID0gdmFsdWVcbiAgICAgIC5maWx0ZXIoZWxlbWVudCA9PiBlbGVtZW50KTtcbiAgICAvLyBJZiB1c2VyIGRvbnQgcGFzcyBkaXNwbGF5ZWRDb2x1bW5zIHRoZSB0YWJsZSB3aWxsIHNob3cgYWxsIGRhdGEgYW5kIHRoZSBuYW1lIG9mIGNvbHVtbnMgd2lsbCBiZSB0aGUga2V5IG9mIGRhdGFcbiAgICBpZiAoIXRoaXMuX2Rpc3BsYXllZENvbHVtbnMpIHtcbiAgICAgIGNvbnN0IGtleXMgPSBbXSwgY0FycmF5ID0gW107XG4gICAgICAvLyBGb3IgY2F0Y2gga2V5cyBvZiBkYXRhIE9iamVjdHMgYW5kIGFzc2luZyB0aXRsZSwga2V5IGFuZCB0eXBlIHN0cmluZyBieSBkZWZhdWx0IHRvIGRpc3BsYXllZENvbHVtbnNcbiAgICAgIHRoaXMuX2RhdGFcbiAgICAgICAgLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKGtleXMuaW5kZXhPZihrZXkpID09PSAtMSkge1xuICAgICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICAgICAgICAgICAgY0FycmF5LnB1c2goeyB0aXRsZToga2V5LCBrZXk6IGtleSwgdHlwZTogJ3N0cmluZycgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIHRoaXMuX2NvbHVtbktleXMgPSBrZXlzO1xuICAgICAgdGhpcy5fZGlzcGxheWVkQ29sdW1ucyA9IGNBcnJheTtcbiAgICAgIC8vIG5lZWQgdG8gY2FsbCBtYXJrRm9yQ2hlY2sgYXMgdGhlIHNldHRlciBjaGFuZ2VzIGRpc3BsYXllZENvbHVtbnMgaGVyZVxuICAgICAgLy8gc2lkZW5vdGU6IGlzbid0IG5lZWRlZCBmb3IgdGhlIGRhdGEgaXRzZWxmIGFzIGl0IGdldHMgcGFzc2VkIHRvIHRoZSBjZGstdGFibGVcbiAgICAgIC8vIGJ5IHRoZSBkYXRhc291cmNlIG9ic2VydmFibGVcbiAgICAgIHRoaXMuX2NoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICB0aGlzLl9kYXRhQ2hhbmdlLm5leHQodGhpcy5fZGF0YSk7XG4gIH1cbiAgZ2V0IGRhdGEoKTogYW55W10ge1xuICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICB9XG5cbiAgLyoqIFNldHMgdGhlIG5hbWUgb3JkZXIgYW5kIHR5cGUgb2YgY29sdW1ucy4gKi9cbiAgQElucHV0KCdueERpc3BsYXllZENvbHVtbnMnKVxuICBzZXQgZGlzcGxheWVkQ29sdW1ucyh2YWx1ZTogTnhEaXNwbGF5ZWRDb2x1bW5zW10pIHtcbiAgICB0aGlzLl9kaXNwbGF5ZWRDb2x1bW5zID0gdmFsdWU7XG4gICAgdGhpcy5fY29sdW1uS2V5cyA9IHZhbHVlLm1hcChjb2x1bW4gPT4gY29sdW1uLmtleSk7XG4gICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gIH1cbiAgZ2V0IGRpc3BsYXllZENvbHVtbnMoKTogTnhEaXNwbGF5ZWRDb2x1bW5zW10ge1xuICAgIHJldHVybiB0aGlzLl9kaXNwbGF5ZWRDb2x1bW5zO1xuICB9XG5cbiAgLyoqIEBkZXByZWNhdGVkIFRoZSBkZWZhdWx0IGFuZCBsaWdodCBoZWFkZXIgc3R5bGluZyB3aWxsIGJlIHJlbW92ZWQuXG4gICAqIEBkZWxldGlvbi10YXJnZXQgOC4wLjBcbiAgKi9cbiAgQElucHV0KCdueFR5cGUnKVxuICBzZXQgc3R5bGVzKHZhbHVlOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5fdGFibGVTdHlsZXMgPT09IHZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2NsYXNzTmFtZXMgPSBtYXBDbGFzc05hbWVzKHZhbHVlLCBERUZBVUxUX0NMQVNTRVMsIE1BUFBJTkcpO1xuICAgIHRoaXMuX3RhYmxlU3R5bGVzID0gdmFsdWU7XG4gICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gIH1cblxuICAvKiogQW4gZXZlbnQgaXMgZGlzcGF0Y2hlZCB3aGVuIGEgcm93IGlzIGNsaWNrZWQuICovXG4gIEBPdXRwdXQoKSBueFJvd0NsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIC8qKiBAZG9jcy1wcml2YXRlICovXG4gIGdldCBkYXRhU291cmNlKCk6IFRhYmxlRGF0YVNvdXJjZSB7XG4gICAgcmV0dXJuIHRoaXMuX2RhdGFTb3VyY2U7XG4gIH1cbiAgLyoqIEBkb2NzLXByaXZhdGUgKi9cbiAgZ2V0IGNsYXNzTmFtZXMoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fY2xhc3NOYW1lcztcbiAgfVxuICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICBnZXQgY29sdW1uS2V5cygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbHVtbktleXM7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBFbGVtZW50UmVmLCBwcml2YXRlIF9jaGFuZ2VEZXRlY3RvclJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYpIHsgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICghdGhpcy5fZGF0YSkge1xuICAgICAgdGhpcy5fZGF0YSA9IFtdO1xuICAgICAgdGhpcy5fZGF0YUNoYW5nZS5uZXh0KHRoaXMuX2RhdGEpO1xuICAgIH1cbiAgICB0aGlzLl9kYXRhU291cmNlID0gbmV3IFRhYmxlRGF0YVNvdXJjZSh0aGlzLl9kYXRhQ2hhbmdlKTtcbiAgfVxuXG4gIC8qKiBAZG9jcy1wcml2YXRlICovXG4gIGhhbmRsZVJvd0NsaWNrKHJvdzogT2JqZWN0KTogdm9pZCB7XG4gICAgdGhpcy5ueFJvd0NsaWNrLmVtaXQocm93KTtcbiAgfVxuXG4gIC8qKiBAZG9jcy1wcml2YXRlICovXG4gIGlzTnVtZXJpYyhlbGVtZW50OiBOeERpc3BsYXllZENvbHVtbnMpOiBib29sZWFuIHtcbiAgICBpZiAoZWxlbWVudC50eXBlID09PSAnbnVtZXJpYycpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxufVxuIl19