/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, EventEmitter, Inject, Input, Optional, Output, } from '@angular/core';
import { DefaultPaginationTexts, NX_PAGINATION_TEXTS } from './pagination-texts';
import { NxPaginationUtils } from './pagination-utils';
/**
 * \@docs-private
 * @record
 */
export function Page() { }
if (false) {
    /** @type {?} */
    Page.prototype.label;
    /** @type {?} */
    Page.prototype.value;
    /** @type {?} */
    Page.prototype.class;
}
export class NxPaginationComponent {
    /**
     * @param {?} paginationTexts
     * @param {?} paginationUtilsService
     * @param {?} _changeDetectorRef
     */
    constructor(paginationTexts, paginationUtilsService, _changeDetectorRef) {
        this.paginationUtilsService = paginationUtilsService;
        this._changeDetectorRef = _changeDetectorRef;
        this._type = 'simple';
        /**
         * \@docs-private
         */
        this.totalNumberPages = 0;
        /**
         * An event emitted when the previous page button is clicked.
         */
        this.nxGoPrev = new EventEmitter();
        /**
         * An event emitted when the next page button is clicked
         */
        this.nxGoNext = new EventEmitter();
        /**
         * An event emitted when a page number is clicked.
         * Provides the number of the page as parameter.
         */
        this.nxGoPage = new EventEmitter();
        this.paginationTexts = paginationTexts || DefaultPaginationTexts;
    }
    /**
     * @return {?}
     */
    get page() { return this._page; }
    /**
     * Sets the current page.
     * @param {?} value
     * @return {?}
     */
    set page(value) {
        this._page = value;
        this._changeDetectorRef.markForCheck();
    }
    /**
     * @return {?}
     */
    get count() { return this._count; }
    /**
     * Number of total items over all pages.
     * @param {?} value
     * @return {?}
     */
    set count(value) {
        this._count = value;
        this.totalNumberPages = this.calculateTotalPages();
        this._changeDetectorRef.markForCheck();
    }
    /**
     * @return {?}
     */
    get perPage() { return this._perPage; }
    /**
     * Sets the number of items you want to show per page.
     * @param {?} value
     * @return {?}
     */
    set perPage(value) {
        this._perPage = value;
        this.totalNumberPages = this.calculateTotalPages();
        this._changeDetectorRef.markForCheck();
    }
    /**
     * @return {?}
     */
    get type() { return this._type; }
    /**
     * Determines the type of pagination.
     *
     * Values: simple |Â advanced, default: simple.
     * @param {?} value
     * @return {?}
     */
    set type(value) {
        this._type = value;
        this._changeDetectorRef.markForCheck();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.totalNumberPages = this.calculateTotalPages();
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        if (this.type === 'advanced' && (!this.paginationTexts.last || !this.paginationTexts.first)) {
            console.warn('Please define aria labels for the last and first arrows.');
        }
    }
    /**
     * Returns the number of the first page.
     * @return {?}
     */
    getMin() {
        return ((this._perPage * this._page) - this._perPage) + 1;
    }
    /**
     * Returns the number of the last page.
     * @return {?}
     */
    getMax() {
        /** @type {?} */
        let max = this._perPage * this._page;
        if (max > this._count) {
            max = this._count;
        }
        return max;
    }
    /**
     * Returns the total number of pages
     * @return {?}
     */
    calculateTotalPages() {
        return Math.ceil(this._count / this._perPage) || 0;
    }
    /**
     * Directs to the page with number n.
     * @param {?} n
     * @return {?}
     */
    onPage(n) {
        this.nxGoPage.emit(n);
    }
    /**
     * Directs to the previous page.
     * @return {?}
     */
    onPrev() {
        if (!this._isPaginationPreviousDisabled()) {
            this.nxGoPrev.emit();
        }
    }
    /**
     * Directs to the next page.
     * @return {?}
     */
    onNext() {
        if (!this._isPaginationNextDisabled()) {
            this.nxGoNext.emit();
        }
    }
    /**
     * Directs to the first page.
     * @return {?}
     */
    onFirst() {
        if (!this._isPaginationPreviousDisabled()) {
            this.onPage(1);
        }
    }
    /**
     * Directs to the last page.
     * @return {?}
     */
    onLast() {
        if (!this._isPaginationNextDisabled()) {
            this.onPage(this.totalNumberPages);
        }
    }
    /**
     * Returns if the current page is the last page.
     * @return {?}
     */
    lastPage() {
        return this._perPage * this._page >= this._count;
    }
    /**
     * \@docs-private
     * @return {?}
     */
    getPages() {
        return this.paginationUtilsService.getPages(this._page, this.totalNumberPages);
    }
    /**
     * \@docs-private
     * @param {?} page
     * @return {?}
     */
    getPaginationItemClasses(page) {
        /** @type {?} */
        const classes = {
            'is-ellipsis': page.label === '...',
            'nx-pagination__item--expanded-view': page.class === 'expanded-view'
        };
        return classes;
    }
    /**
     * \@docs-private
     * @param {?} page
     * @return {?}
     */
    getPaginationNumberClasses(page) {
        /** @type {?} */
        const classes = {
            'is-active': page.value === this.page,
            'nx-pagination__ellipsis': page.label === '...',
            'nx-pagination__link': page.label !== '...'
        };
        return classes;
    }
    /**
     * Returns true, if `nxCount` is greater than 0, else false.
     * @return {?}
     */
    isPaginationVisible() {
        return this.count > 0;
    }
    /**
     * Returns true, if `nxCount` is greater than 0 and the type of pagination is 'simple', else false.
     * @return {?}
     */
    isPaginationCompactVisible() {
        return this.type.includes('simple') && this.count > 0;
    }
    /**
     * \@docs-private
     * @return {?}
     */
    isPaginationContainerVisible() {
        return this.type.includes('advanced');
    }
    /**
     * @return {?}
     */
    _isPaginationPreviousDisabled() {
        return this.page === this.getMin();
    }
    /**
     * @return {?}
     */
    _isPaginationNextDisabled() {
        return this.page === this.totalNumberPages;
    }
}
NxPaginationComponent.decorators = [
    { type: Component, args: [{
                selector: 'nx-pagination',
                template: "<nav *ngIf=\"isPaginationVisible()\"  aria-label=\"Page navigation\" class=\"nx-pagination\" >\n  <ul *ngIf=\"isPaginationContainerVisible()\"  [attr.aria-label]=\"paginationTexts.ariaLabel\" class=\"nx-pagination__container\">\n    <li class=\"nx-pagination__item\">\n      <button\n        [attr.aria-label]=\"paginationTexts.first\"\n        [class.is-disabled]=\"_isPaginationPreviousDisabled()\"\n        [tabindex]=\"_isPaginationPreviousDisabled() ? -1 : 0\"\n        class=\"nx-pagination__link nx-pagination__link--first\"\n        (click)=\"onFirst()\">\n        <nx-icon class=\"nx-pagination__arrow\" name=\"arrow-first\"></nx-icon>\n      </button>\n    </li>\n    <li class=\"nx-pagination__item nx-pagination__item-previous\">\n      <button\n        [attr.aria-label]=\"paginationTexts.previous\"\n        [class.is-disabled]=\"_isPaginationPreviousDisabled()\"\n        [tabindex]=\"_isPaginationPreviousDisabled() ? -1 : 0\"\n        class=\"nx-pagination__link nx-pagination__link--previous\"\n        (click)=\"onPrev()\">\n        <nx-icon class=\"nx-pagination__arrow\" name=\"arrow-left\"></nx-icon>\n      </button>\n    </li>\n    <li *ngFor=\"let pageNum of getPages()\" class=\"nx-pagination__item\" [ngClass]=\"getPaginationItemClasses(pageNum)\">\n      <button class=\"nx-pagination--number\"\n        *ngIf=\"pageNum.label !== '...'\"\n        (click)=\"onPage(pageNum.value)\"\n        [attr.aria-curent]=\"pageNum.value === page\"\n        [ngClass]=\"getPaginationNumberClasses(pageNum)\">\n        {{ pageNum.label }}\n      </button>\n      <span *ngIf=\"pageNum.label === '...'\">\n        {{ pageNum.label }}\n      </span>\n    </li>\n    <li class=\"nx-pagination__item nx-pagination__item-next\">\n      <button\n        [attr.aria-label]=\"paginationTexts.next\"\n        [class.is-disabled]=\"_isPaginationNextDisabled()\"\n        [tabindex]=\"_isPaginationNextDisabled() ? -1 : 0\"\n        class=\"nx-pagination__link nx-pagination__link--next\"\n        (click)=\"onNext()\">\n        <nx-icon class=\"nx-pagination__arrow\" name=\"arrow-right\"></nx-icon>\n      </button>\n    </li>\n    <li class=\"nx-pagination__item\">\n      <button\n        [attr.aria-label]=\"paginationTexts.last\"\n        [class.is-disabled]=\"_isPaginationNextDisabled()\"\n        [tabindex]=\"_isPaginationNextDisabled() ? -1 : 0\"\n        class=\"nx-pagination__link nx-pagination__link--last\"\n        (click)=\"onLast()\">\n        <nx-icon class=\"nx-pagination__arrow\" name=\"arrow-last\"></nx-icon>\n      </button>\n    </li>\n  </ul>\n</nav>\n<nav *ngIf=\"isPaginationCompactVisible()\" [attr.aria-label]=\"paginationTexts.ariaLabel\" class=\"nx-pagination-compact\" >\n  <button [attr.aria-label]=\"paginationTexts.previous\"\n    class=\"nx-pagination-compact__previous\"\n    [class.is-disabled]=\"_isPaginationPreviousDisabled()\"\n    [tabindex]=\"_isPaginationPreviousDisabled() ? -1 : 0\"\n\n    (click)=\"onPrev()\">\n    <nx-icon class=\"nx-pagination__arrow\" name=\"arrow-left\"></nx-icon>\n    <span class=\"nx-pagination-compact__direction-label\">\n      {{ paginationTexts.previous }}\n    </span>\n  </button>\n  <div class=\"nx-pagination-compact__display\">\n      <span class=\"nx-pagination-compact__current-page\">{{ page }}</span>\n      <span class=\"nx-pagination-compact__page-separator\"> {{ paginationTexts.ofLabel }} </span>\n      <span class=\"nx-pagination-compact__total-pages\">{{ totalNumberPages }}</span>\n  </div>\n  <button\n    class=\"nx-pagination-compact__next\"\n    [class.is-disabled]=\"_isPaginationNextDisabled()\"\n    [tabindex]=\"_isPaginationNextDisabled() ? -1 : 0\"\n    [attr.aria-label]=\"paginationTexts.next\"\n    (click)=\"onNext()\">\n    <span class=\"nx-pagination-compact__direction-label\"> {{ paginationTexts.next }} </span>\n    <nx-icon class=\"nx-pagination__arrow\" name=\"arrow-right\"></nx-icon>\n  </button>\n</nav>\n",
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: [":host button:focus{outline:0}:host button::-moz-focus-inner{border:0}.nx-pagination__container{display:flex;font-size:16px;margin:8px 0;padding:0}@media (min-width:704px){.nx-pagination__container{margin:8px 0 40px}}.nx-pagination__item{margin:0 16px;list-style:none}.nx-pagination__item:first-child,.nx-pagination__item:last-child{margin:0}.nx-pagination__item.is-ellipsis{font-weight:700}.nx-pagination__item--expanded-view{display:block}.nx-pagination__link{color:#006192;font-weight:600;padding:0;text-decoration:none;background-color:#fff;border:0;cursor:pointer}.nx-pagination__link.is-active{color:#414141;font-weight:700;cursor:default}nx-icon.nx-pagination__arrow{font-size:24px}.nx-pagination-compact{display:flex;font-size:16px;margin:16px 0;padding:0}@media (min-width:704px){.nx-pagination-compact{margin:40px 0}}.nx-pagination-compact__display{color:#414141;display:flex;line-height:24px}.nx-pagination-compact__current-page{font-weight:700;margin-right:8px}.nx-pagination-compact__total-pages{margin-left:8px}.nx-pagination-compact__next,.nx-pagination-compact__previous,.nx-pagination__arrow-first,.nx-pagination__arrow-last{color:#006192;font-weight:600;text-decoration:none;text-transform:uppercase;display:flex;align-items:center;padding:0;background-color:#fff;cursor:pointer;border:0}.nx-pagination-compact__previous{margin-right:32px}.nx-pagination-compact__next{margin-left:32px}.nx-pagination-compact__direction-label{display:block;letter-spacing:1px}.nx-pagination-compact__direction-label:first-child{margin-right:8px}.nx-pagination-compact__direction-label:last-child{margin-left:8px}.nx-pagination-compact__next.is-disabled,.nx-pagination-compact__previous.is-disabled,.nx-pagination__link.is-disabled{color:rgba(0,97,146,.4);cursor:not-allowed}:host-context([data-whatinput=keyboard]) .nx-pagination--number:focus,:host-context([data-whatinput=keyboard]) .nx-pagination-compact__next:focus,:host-context([data-whatinput=keyboard]) .nx-pagination-compact__previous:focus,:host-context([data-whatinput=keyboard]) .nx-pagination__link:focus{box-shadow:0 0 0 2px #fff,0 0 0 6px #009de6;border-radius:4px}.nx-pagination__link--first,.nx-pagination__link--last,.nx-pagination__link--next,.nx-pagination__link--previous{display:flex;align-items:center}.nx-pagination__item-next{margin-right:8px}.nx-pagination__item-previous{margin-left:8px}"]
            }] }
];
/** @nocollapse */
NxPaginationComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [NX_PAGINATION_TEXTS,] }] },
    { type: NxPaginationUtils },
    { type: ChangeDetectorRef }
];
NxPaginationComponent.propDecorators = {
    page: [{ type: Input, args: ['nxPage',] }],
    count: [{ type: Input, args: ['nxCount',] }],
    perPage: [{ type: Input, args: ['nxPerPage',] }],
    type: [{ type: Input, args: ['nxType',] }],
    nxGoPrev: [{ type: Output }],
    nxGoNext: [{ type: Output }],
    nxGoPage: [{ type: Output }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    NxPaginationComponent.prototype._page;
    /**
     * @type {?}
     * @private
     */
    NxPaginationComponent.prototype._count;
    /**
     * @type {?}
     * @private
     */
    NxPaginationComponent.prototype._perPage;
    /**
     * @type {?}
     * @private
     */
    NxPaginationComponent.prototype._type;
    /**
     * \@docs-private
     * @type {?}
     */
    NxPaginationComponent.prototype.paginationTexts;
    /**
     * \@docs-private
     * @type {?}
     */
    NxPaginationComponent.prototype.totalNumberPages;
    /**
     * An event emitted when the previous page button is clicked.
     * @type {?}
     */
    NxPaginationComponent.prototype.nxGoPrev;
    /**
     * An event emitted when the next page button is clicked
     * @type {?}
     */
    NxPaginationComponent.prototype.nxGoNext;
    /**
     * An event emitted when a page number is clicked.
     * Provides the number of the page as parameter.
     * @type {?}
     */
    NxPaginationComponent.prototype.nxGoPage;
    /**
     * @type {?}
     * @private
     */
    NxPaginationComponent.prototype.paginationUtilsService;
    /**
     * @type {?}
     * @private
     */
    NxPaginationComponent.prototype._changeDetectorRef;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnaW5hdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYWxsaWFuei9uZ3gtbmRieC8iLCJzb3VyY2VzIjpbInBhZ2luYXRpb24vcGFnaW5hdGlvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxZQUFZLEVBQ1osTUFBTSxFQUNOLEtBQUssRUFFTCxRQUFRLEVBQ1IsTUFBTSxHQUVQLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxzQkFBc0IsRUFBb0IsbUJBQW1CLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNuRyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQzs7Ozs7QUFHdkQsMEJBSUM7OztJQUhDLHFCQUFjOztJQUNkLHFCQUFXOztJQUNYLHFCQUFjOztBQVVoQixNQUFNLE9BQU8scUJBQXFCOzs7Ozs7SUErRGhDLFlBQzZDLGVBQWlDLEVBQ2xFLHNCQUF5QyxFQUN6QyxrQkFBcUM7UUFEckMsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUFtQjtRQUN6Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW1CO1FBOUR6QyxVQUFLLEdBQVcsUUFBUSxDQUFDOzs7O1FBTWpDLHFCQUFnQixHQUFXLENBQUMsQ0FBQzs7OztRQTBDbkIsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFRLENBQUM7Ozs7UUFHcEMsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFRLENBQUM7Ozs7O1FBTXBDLGFBQVEsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBTTlDLElBQUksQ0FBQyxlQUFlLEdBQUcsZUFBZSxJQUFJLHNCQUFzQixDQUFDO0lBQ2xFLENBQUM7Ozs7SUF4REYsSUFBSSxJQUFJLEtBQWEsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQzs7Ozs7O0lBR3pDLElBQ0ksSUFBSSxDQUFDLEtBQWE7UUFD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LElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7SUFDeEQsQ0FBQzs7Ozs7SUFHRCw0QkFBNEI7UUFDMUIsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN4QyxDQUFDOzs7O0lBRUQsNkJBQTZCO1FBQzNCLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDckMsQ0FBQzs7OztJQUVELHlCQUF5QjtRQUN2QixPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLGdCQUFnQixDQUFDO0lBQzdDLENBQUM7OztZQTdMRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLGVBQWU7Z0JBQ3pCLHEySEFBMEM7Z0JBQzFDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNOzthQUVoRDs7Ozs0Q0FrRU0sUUFBUSxZQUFJLE1BQU0sU0FBQyxtQkFBbUI7WUFoRnBDLGlCQUFpQjtZQVp4QixpQkFBaUI7OzttQkEyQ2hCLEtBQUssU0FBQyxRQUFRO29CQVFkLEtBQUssU0FBQyxTQUFTO3NCQVNmLEtBQUssU0FBQyxXQUFXO21CQWFqQixLQUFLLFNBQUMsUUFBUTt1QkFPZCxNQUFNO3VCQUdOLE1BQU07dUJBTU4sTUFBTTs7Ozs7OztJQTVEUCxzQ0FBc0I7Ozs7O0lBQ3RCLHVDQUF1Qjs7Ozs7SUFDdkIseUNBQXlCOzs7OztJQUN6QixzQ0FBaUM7Ozs7O0lBR2pDLGdEQUFrQzs7Ozs7SUFHbEMsaURBQTZCOzs7OztJQTBDN0IseUNBQThDOzs7OztJQUc5Qyx5Q0FBOEM7Ozs7OztJQU05Qyx5Q0FBZ0Q7Ozs7O0lBSTVDLHVEQUFpRDs7Ozs7SUFDakQsbURBQTZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5qZWN0LFxuICBJbnB1dCxcbiAgT25Jbml0LFxuICBPcHRpb25hbCxcbiAgT3V0cHV0LFxuICBBZnRlckNvbnRlbnRJbml0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgRGVmYXVsdFBhZ2luYXRpb25UZXh0cywgSVBhZ2luYXRpb25UZXh0cywgTlhfUEFHSU5BVElPTl9URVhUUyB9IGZyb20gJy4vcGFnaW5hdGlvbi10ZXh0cyc7XG5pbXBvcnQgeyBOeFBhZ2luYXRpb25VdGlscyB9IGZyb20gJy4vcGFnaW5hdGlvbi11dGlscyc7XG5cbi8qKiBAZG9jcy1wcml2YXRlICovXG5leHBvcnQgaW50ZXJmYWNlIFBhZ2Uge1xuICBsYWJlbDogc3RyaW5nO1xuICB2YWx1ZTogYW55O1xuICBjbGFzczogc3RyaW5nO1xufVxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdueC1wYWdpbmF0aW9uJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3BhZ2luYXRpb24uY29tcG9uZW50Lmh0bWwnLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgc3R5bGVVcmxzOiBbICcuL3BhZ2luYXRpb24uY29tcG9uZW50LnNjc3MnIF0sXG59KVxuXG5leHBvcnQgY2xhc3MgTnhQYWdpbmF0aW9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlckNvbnRlbnRJbml0IHtcbiAgcHJpdmF0ZSBfcGFnZTogbnVtYmVyO1xuICBwcml2YXRlIF9jb3VudDogbnVtYmVyO1xuICBwcml2YXRlIF9wZXJQYWdlOiBudW1iZXI7XG4gIHByaXZhdGUgX3R5cGU6IHN0cmluZyA9ICdzaW1wbGUnO1xuXG4gIC8qKiBAZG9jcy1wcml2YXRlICovXG4gIHBhZ2luYXRpb25UZXh0czogSVBhZ2luYXRpb25UZXh0cztcblxuICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICB0b3RhbE51bWJlclBhZ2VzOiBudW1iZXIgPSAwO1xuXG4gIGdldCBwYWdlKCk6IG51bWJlciB7IHJldHVybiB0aGlzLl9wYWdlOyB9XG5cbiAgLyoqIFNldHMgdGhlIGN1cnJlbnQgcGFnZS4gKi9cbiAgQElucHV0KCdueFBhZ2UnKSAvLyB0aGUgY3VycmVudCBwYWdlXG4gIHNldCBwYWdlKHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9wYWdlID0gdmFsdWU7XG4gICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gIH1cbiAgZ2V0IGNvdW50KCk6IG51bWJlciB7IHJldHVybiB0aGlzLl9jb3VudDsgfVxuXG4gIC8qKiBOdW1iZXIgb2YgdG90YWwgaXRlbXMgb3ZlciBhbGwgcGFnZXMuICovXG4gIEBJbnB1dCgnbnhDb3VudCcpIC8vIGhvdyBtYW55IHRvdGFsIGl0ZW1zIHRoZXJlIGFyZSBpbiBhbGwgcGFnZXNcbiAgc2V0IGNvdW50KHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9jb3VudCA9IHZhbHVlO1xuICAgIHRoaXMudG90YWxOdW1iZXJQYWdlcyA9ICB0aGlzLmNhbGN1bGF0ZVRvdGFsUGFnZXMoKTtcbiAgICB0aGlzLl9jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgfVxuICBnZXQgcGVyUGFnZSgpOiBudW1iZXIgeyByZXR1cm4gdGhpcy5fcGVyUGFnZTsgfVxuXG4gIC8qKiBTZXRzIHRoZSBudW1iZXIgb2YgaXRlbXMgeW91IHdhbnQgdG8gc2hvdyBwZXIgcGFnZS4gKi9cbiAgQElucHV0KCdueFBlclBhZ2UnKSAvLyBob3cgbWFueSBpdGVtcyB3ZSB3YW50IHRvIHNob3cgcGVyIHBhZ2VcbiAgc2V0IHBlclBhZ2UodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX3BlclBhZ2UgPSB2YWx1ZTtcbiAgICB0aGlzLnRvdGFsTnVtYmVyUGFnZXMgPSAgdGhpcy5jYWxjdWxhdGVUb3RhbFBhZ2VzKCk7XG4gICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gIH1cbiAgZ2V0IHR5cGUoKTogc3RyaW5nIHsgcmV0dXJuIHRoaXMuX3R5cGU7IH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyB0aGUgdHlwZSBvZiBwYWdpbmF0aW9uLlxuICAgKlxuICAgKiBWYWx1ZXM6IHNpbXBsZSB8wqBhZHZhbmNlZCwgZGVmYXVsdDogc2ltcGxlLlxuICAgKi9cbiAgQElucHV0KCdueFR5cGUnKVxuICBzZXQgdHlwZSh2YWx1ZTogc3RyaW5nKSB7IC8vIHR5cGUgYWR2YW5jZWQgb3Igc2ltcGxlXG4gICAgdGhpcy5fdHlwZSA9IHZhbHVlO1xuICAgIHRoaXMuX2NoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICB9XG5cbiAgLyoqIEFuIGV2ZW50IGVtaXR0ZWQgd2hlbiB0aGUgcHJldmlvdXMgcGFnZSBidXR0b24gaXMgY2xpY2tlZC4gKi9cbiAgQE91dHB1dCgpIG54R29QcmV2ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gIC8qKiBBbiBldmVudCBlbWl0dGVkIHdoZW4gdGhlIG5leHQgcGFnZSBidXR0b24gaXMgY2xpY2tlZCAqL1xuICBAT3V0cHV0KCkgbnhHb05leHQgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgLyoqXG4gICAqIEFuIGV2ZW50IGVtaXR0ZWQgd2hlbiBhIHBhZ2UgbnVtYmVyIGlzIGNsaWNrZWQuXG4gICAqIFByb3ZpZGVzIHRoZSBudW1iZXIgb2YgdGhlIHBhZ2UgYXMgcGFyYW1ldGVyLlxuICAgKi9cbiAgQE91dHB1dCgpIG54R29QYWdlID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgICBAT3B0aW9uYWwoKSBASW5qZWN0KE5YX1BBR0lOQVRJT05fVEVYVFMpIHBhZ2luYXRpb25UZXh0czogSVBhZ2luYXRpb25UZXh0cyxcbiAgICAgIHByaXZhdGUgcGFnaW5hdGlvblV0aWxzU2VydmljZTogTnhQYWdpbmF0aW9uVXRpbHMsXG4gICAgICBwcml2YXRlIF9jaGFuZ2VEZXRlY3RvclJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcbiAgICB0aGlzLnBhZ2luYXRpb25UZXh0cyA9IHBhZ2luYXRpb25UZXh0cyB8fCBEZWZhdWx0UGFnaW5hdGlvblRleHRzO1xuICAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMudG90YWxOdW1iZXJQYWdlcyA9ICB0aGlzLmNhbGN1bGF0ZVRvdGFsUGFnZXMoKTtcbiAgfVxuXG4gIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcbiAgICBpZiAodGhpcy50eXBlID09PSAnYWR2YW5jZWQnICYmICghdGhpcy5wYWdpbmF0aW9uVGV4dHMubGFzdCB8fCAhdGhpcy5wYWdpbmF0aW9uVGV4dHMuZmlyc3QpKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1BsZWFzZSBkZWZpbmUgYXJpYSBsYWJlbHMgZm9yIHRoZSBsYXN0IGFuZCBmaXJzdCBhcnJvd3MuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFJldHVybnMgdGhlIG51bWJlciBvZiB0aGUgZmlyc3QgcGFnZS4gKi9cbiAgZ2V0TWluKCk6IG51bWJlciB7XG4gICAgcmV0dXJuICgodGhpcy5fcGVyUGFnZSAqIHRoaXMuX3BhZ2UpIC0gdGhpcy5fcGVyUGFnZSkgKyAxO1xuICB9XG5cbiAgLyoqIFJldHVybnMgdGhlIG51bWJlciBvZiB0aGUgbGFzdCBwYWdlLiAqL1xuICBnZXRNYXgoKTogbnVtYmVyIHtcbiAgICBsZXQgbWF4ID0gdGhpcy5fcGVyUGFnZSAqIHRoaXMuX3BhZ2U7XG4gICAgaWYgKG1heCA+IHRoaXMuX2NvdW50KSB7XG4gICAgICBtYXggPSB0aGlzLl9jb3VudDtcbiAgICB9XG4gICAgcmV0dXJuIG1heDtcbiAgfVxuXG4gIC8qKiBSZXR1cm5zIHRoZSB0b3RhbCBudW1iZXIgb2YgcGFnZXMgKi9cbiAgY2FsY3VsYXRlVG90YWxQYWdlcygpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmNlaWwodGhpcy5fY291bnQgLyB0aGlzLl9wZXJQYWdlKSB8fCAwO1xuICB9XG5cbiAgLyoqIERpcmVjdHMgdG8gdGhlIHBhZ2Ugd2l0aCBudW1iZXIgbi4gKi9cbiAgb25QYWdlKG46IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMubnhHb1BhZ2UuZW1pdChuKTtcbiAgfVxuXG4gIC8qKiBEaXJlY3RzIHRvIHRoZSBwcmV2aW91cyBwYWdlLiAqL1xuICBvblByZXYoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLl9pc1BhZ2luYXRpb25QcmV2aW91c0Rpc2FibGVkKCkpIHtcbiAgICAgIHRoaXMubnhHb1ByZXYuZW1pdCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBEaXJlY3RzIHRvIHRoZSBuZXh0IHBhZ2UuICovXG4gIG9uTmV4dCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuX2lzUGFnaW5hdGlvbk5leHREaXNhYmxlZCgpKSB7XG4gICAgICB0aGlzLm54R29OZXh0LmVtaXQoKTtcbiAgICB9XG4gIH1cblxuICAvKiogRGlyZWN0cyB0byB0aGUgZmlyc3QgcGFnZS4gKi9cbiAgb25GaXJzdCgpIHtcbiAgICBpZiAoIXRoaXMuX2lzUGFnaW5hdGlvblByZXZpb3VzRGlzYWJsZWQoKSkge1xuICAgICAgdGhpcy5vblBhZ2UoMSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIERpcmVjdHMgdG8gdGhlIGxhc3QgcGFnZS4gKi9cbiAgb25MYXN0KCkge1xuICAgIGlmICghdGhpcy5faXNQYWdpbmF0aW9uTmV4dERpc2FibGVkKCkpIHtcbiAgICAgIHRoaXMub25QYWdlKHRoaXMudG90YWxOdW1iZXJQYWdlcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFJldHVybnMgaWYgdGhlIGN1cnJlbnQgcGFnZSBpcyB0aGUgbGFzdCBwYWdlLiAqL1xuICBsYXN0UGFnZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fcGVyUGFnZSAqIHRoaXMuX3BhZ2UgPj0gdGhpcy5fY291bnQ7XG4gIH1cblxuICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICBnZXRQYWdlcygpOiBQYWdlW10ge1xuICAgIHJldHVybiB0aGlzLnBhZ2luYXRpb25VdGlsc1NlcnZpY2UuZ2V0UGFnZXModGhpcy5fcGFnZSwgdGhpcy50b3RhbE51bWJlclBhZ2VzKTtcbiAgfVxuXG4gIC8qKiBAZG9jcy1wcml2YXRlICovXG4gIGdldFBhZ2luYXRpb25JdGVtQ2xhc3NlcyhwYWdlOiBQYWdlKTogT2JqZWN0IHtcbiAgICBjb25zdCBjbGFzc2VzID0ge1xuICAgICAgJ2lzLWVsbGlwc2lzJzogcGFnZS5sYWJlbCA9PT0gJy4uLicsXG4gICAgICAnbngtcGFnaW5hdGlvbl9faXRlbS0tZXhwYW5kZWQtdmlldyc6IHBhZ2UuY2xhc3MgPT09ICdleHBhbmRlZC12aWV3J1xuICAgIH07XG4gICAgcmV0dXJuIGNsYXNzZXM7XG4gIH1cblxuICAvKiogQGRvY3MtcHJpdmF0ZSAqL1xuICBnZXRQYWdpbmF0aW9uTnVtYmVyQ2xhc3NlcyhwYWdlOiBQYWdlKTogT2JqZWN0IHtcbiAgICBjb25zdCBjbGFzc2VzID0ge1xuICAgICAgJ2lzLWFjdGl2ZSc6IHBhZ2UudmFsdWUgPT09IHRoaXMucGFnZSxcbiAgICAgICdueC1wYWdpbmF0aW9uX19lbGxpcHNpcyc6IHBhZ2UubGFiZWwgPT09ICcuLi4nLFxuICAgICAgJ254LXBhZ2luYXRpb25fX2xpbmsnOiBwYWdlLmxhYmVsICE9PSAnLi4uJ1xuICAgIH07XG4gICAgcmV0dXJuIGNsYXNzZXM7XG4gIH1cblxuICAvKiogUmV0dXJucyB0cnVlLCBpZiBgbnhDb3VudGAgaXMgZ3JlYXRlciB0aGFuIDAsIGVsc2UgZmFsc2UuICovXG4gIGlzUGFnaW5hdGlvblZpc2libGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuY291bnQgPiAwO1xuICB9XG5cbiAgLyoqIFJldHVybnMgdHJ1ZSwgaWYgYG54Q291bnRgIGlzIGdyZWF0ZXIgdGhhbiAwIGFuZCB0aGUgdHlwZSBvZiBwYWdpbmF0aW9uIGlzICdzaW1wbGUnLCBlbHNlIGZhbHNlLiAqL1xuICBpc1BhZ2luYXRpb25Db21wYWN0VmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy50eXBlLmluY2x1ZGVzKCdzaW1wbGUnKSAmJiB0aGlzLmNvdW50ID4gMDtcbiAgfVxuXG4gIC8qKiBAZG9jcy1wcml2YXRlICovXG4gIGlzUGFnaW5hdGlvbkNvbnRhaW5lclZpc2libGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMudHlwZS5pbmNsdWRlcygnYWR2YW5jZWQnKTtcbiAgfVxuXG4gIF9pc1BhZ2luYXRpb25QcmV2aW91c0Rpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnBhZ2UgPT09IHRoaXMuZ2V0TWluKCk7XG4gIH1cblxuICBfaXNQYWdpbmF0aW9uTmV4dERpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnBhZ2UgPT09IHRoaXMudG90YWxOdW1iZXJQYWdlcztcbiAgfVxufVxuIl19